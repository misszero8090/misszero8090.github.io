<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="靠北’s Notes">
<meta property="og:url" content="http://he8090.cn/index.html">
<meta property="og:site_name" content="靠北’s Notes">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="靠北’s Notes">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://he8090.cn/"/>





  <title>靠北’s Notes</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6961312303680db8ea4d5558f73d8325";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">靠北’s Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">我用文字记忆，青春年华。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/07/12/hpple的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/12/hpple的使用/" itemprop="url">hpple的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-12T09:30:20+08:00">
                2017-07-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> hpple在网页解析方面有很重要的作用，本次项目中用到合作单位提供的一个信号标识，但是对方不提供接口只提供HTML网页解析，所以客户端只能拿到HTML源码之后对HTML源码进行解析，拿到自己需要的数据。</p>
<blockquote>
<p>demo地址：<a href="https://github.com/misszero8090/httpParse" target="_blank" rel="external">https://github.com/misszero8090/httpParse</a></p>
</blockquote>
<ul>
<li><p>先下载hpple库，推荐使用cocoapods导入，但因我们项目原因，这里重点说后者，手动导入。去github下载包，地址：<a href="https://github.com/topfunky/hpple" target="_blank" rel="external">https://github.com/topfunky/hpple</a></p>
</li>
<li><p>将库引入project , 添加静态库<code>libxml2.2.dylib</code>，注意我使用的是<code>xcode8.3.3 iOS10</code>开发，默认情况下是<code>.tbd</code>， 因为库需要用<code>.dylib</code>，所以在/usr/lib目录下还有.dylib文件。</p>
</li>
<li><p>在<code>header search path</code>设置<code>$(SDKROOT)/usr/lib/libxml2</code>。</p>
</li>
<li>在<code>user Heather search path</code>设置<code>$(SDKROOT)/usr/include/libxml2</code></li>
<li><p>在<code>FrameWork search path</code>设置<code>/usr/lib/libxml2.2.dylib</code></p>
</li>
<li><p>以上设置完成之后，导入<code>#import &quot;TFHpple.h&quot;</code></p>
</li>
</ul>
<p>Objective-C解析HTML&lt;后附 RSSI.html源代码&gt;<br>拿到rssi后面的值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">NSString *htmlPath = [[NSBundle mainBundle] pathForResource:@&quot;RSSI&quot; ofType:@&quot;html&quot;];</div><div class="line">    NSData *htmlData = [NSData dataWithContentsOfFile:htmlPath];</div><div class="line"></div><div class="line">    TFHpple *doc = [[TFHpple alloc] initWithHTMLData:htmlData];</div><div class="line">    NSArray *elements = [doc searchWithXPathQuery:@&quot;//fieldset[@class=&apos;cbi-section&apos;]&quot;];</div><div class="line"></div><div class="line">    for (TFHppleElement *elment in elements) &#123;</div><div class="line">    for (TFHppleElement *el in [elment children]) &#123;</div><div class="line"></div><div class="line">        NSArray *els =  [el searchWithXPathQuery:@&quot;//table&quot;];</div><div class="line">        for (TFHppleElement *e in els) &#123;</div><div class="line">            for (TFHppleElement *table in [e children]) &#123;</div><div class="line"></div><div class="line">                NSArray *tables = [table children];</div><div class="line">                for (TFHppleElement *tr in tables) &#123;</div><div class="line"></div><div class="line">                    if ([[tr text] isEqualToString:@&quot;RSSI&quot;]) &#123;</div><div class="line">                        NSUInteger index = [tables indexOfObject:tr];</div><div class="line">                        NSLog(@&quot;text:%@&quot;,[tr text]);</div><div class="line">                        NSLog(@&quot;index:%ld&quot;,index);</div><div class="line"></div><div class="line">                        TFHppleElement *rssi = tables[index + 1];</div><div class="line"></div><div class="line">                        NSLog(@&quot;rssi:%@&quot;,[rssi text]);</div><div class="line">                    &#125;  </div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;    </div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//方法2：硬拿 &lt;知道元素的位置，且网页结构不会发生改变&gt;</div><div class="line">TFHppleElement *element = elements[2];</div><div class="line">NSArray *els = [element children];</div><div class="line">TFHppleElement *el = els[3];</div><div class="line">NSArray *es = [el children];</div><div class="line">TFHppleElement *e = es[9];</div><div class="line">NSArray *ls = [e children];</div><div class="line">TFHppleElement *l = ls.lastObject;</div><div class="line"> NSLog(@&quot;html:%@&quot;,[l text]);</div></pre></td></tr></table></figure>
<p>附：RSSI.HTML文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</div><div class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;zh-cn&quot; lang=&quot;zh-cn&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</div><div class="line">&lt;meta http-equiv=&quot;Content-Script-Type&quot; content=&quot;text/javascript&quot; /&gt;</div><div class="line">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;/luci-static/openwrt.org/cascade.css&quot; /&gt;</div><div class="line">&lt;!--[if IE 6]&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;/luci-static/openwrt.org/ie6.css&quot; /&gt;&lt;![endif]--&gt;</div><div class="line">&lt;!--[if IE 7]&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;/luci-static/openwrt.org/ie7.css&quot; /&gt;&lt;![endif]--&gt;</div><div class="line">&lt;!--[if IE 8]&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;/luci-static/openwrt.org/ie8.css&quot; /&gt;&lt;![endif]--&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/luci-static/resources/xhr.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;title&gt;NHRT - 总览 - LuCI&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body class=&quot;lang_zh-cn&quot;&gt;</div><div class="line"></div><div class="line">&lt;p class=&quot;skiplink&quot;&gt;</div><div class="line">&lt;span id=&quot;skiplink1&quot;&gt;&lt;a href=&quot;#navigation&quot;&gt;跳转到导航&lt;/a&gt;&lt;/span&gt;</div><div class="line">&lt;span id=&quot;skiplink2&quot;&gt;&lt;a href=&quot;#content&quot;&gt;跳到内容&lt;/a&gt;&lt;/span&gt;</div><div class="line">&lt;/p&gt;</div><div class="line"></div><div class="line">&lt;div id=&quot;menubar&quot;&gt;</div><div class="line">&lt;h2 class=&quot;navigation&quot;&gt;&lt;a id=&quot;navigation&quot; name=&quot;navigation&quot;&gt;导航&lt;/a&gt;&lt;/h2&gt;</div><div class="line"></div><div class="line">&lt;div class=&quot;hostinfo&quot;&gt;</div><div class="line">	NHRT | Cobra  P015C005B025 |</div><div class="line">	负载: 0.45 0.47 0.21</div><div class="line">	&lt;span id=&quot;xhr_poll_status&quot; style=&quot;display:none&quot; onclick=&quot;XHR.running() ? XHR.halt() : XHR.run()&quot;&gt;</div><div class="line">		| 自动刷新:</div><div class="line">		&lt;span id=&quot;xhr_poll_status_on&quot;&gt;开&lt;/span&gt;</div><div class="line">		&lt;span id=&quot;xhr_poll_status_off&quot; style=&quot;display:none&quot;&gt;关&lt;/span&gt;</div><div class="line">	&lt;/span&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&lt;div id=&quot;savemenu&quot;&gt;</div><div class="line">	&lt;a href=&quot;#&quot;&gt;修改数: 0&lt;/a&gt;</div><div class="line">	&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;div id=&quot;maincontainer&quot;&gt;</div><div class="line">	&lt;div id=&quot;tabmenu&quot;&gt;</div><div class="line"></div><div class="line">	&lt;div class=&quot;tabmenu1&quot;&gt;</div><div class="line">	&lt;ul class=&quot;tabmenu l1&quot;&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-status active&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/&quot;&gt;状态&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-system&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/system/&quot;&gt;系统&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-services&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/services/&quot;&gt;服务&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-network&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/network/&quot;&gt;网络&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-logout&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/logout/&quot;&gt;退出&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">	&lt;/ul&gt;</div><div class="line">	&lt;br style=&quot;clear:both&quot; /&gt;</div><div class="line"></div><div class="line">	&lt;div class=&quot;tabmenu2&quot;&gt;</div><div class="line">	&lt;ul class=&quot;tabmenu l2&quot;&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-overview active&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/overview/&quot;&gt;总览&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-iptables&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/iptables/&quot;&gt;防火墙&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-routes&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/routes/&quot;&gt;路由表&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-syslog&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/syslog/&quot;&gt;系统日志&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-dmesg&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/dmesg/&quot;&gt;内核日志&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-modemlog&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/modemlog/&quot;&gt;Modem日志&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-rules&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/rules/&quot;&gt;路由规则&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">			&lt;li class=&quot;tabmenu-item-realtime&quot;&gt;</div><div class="line">				&lt;a href=&quot;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b/admin/status/realtime/&quot;&gt;实时信息&lt;/a&gt;</div><div class="line">			&lt;/li&gt;</div><div class="line"></div><div class="line">	&lt;/ul&gt;</div><div class="line">	&lt;br style=&quot;clear:both&quot; /&gt;</div><div class="line"></div><div class="line">	&lt;/div&gt;</div><div class="line"></div><div class="line">	&lt;/div&gt;</div><div class="line"></div><div class="line">	&lt;/div&gt;</div><div class="line"></div><div class="line">	&lt;div id=&quot;maincontent&quot;&gt;</div><div class="line">		&lt;noscript&gt;</div><div class="line">			&lt;div class=&quot;errorbox&quot;&gt;</div><div class="line">				&lt;strong&gt;需要Java Script！&lt;/strong&gt;&lt;br /&gt;</div><div class="line">				LUCI的正常运行需要开启浏览器的Java Script支持。</div><div class="line">			&lt;/div&gt;</div><div class="line">		&lt;/noscript&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/luci-static/resources/cbi.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;//&lt;![CDATA[</div><div class="line">	function progressbar(v, m)</div><div class="line">	&#123;</div><div class="line">		var vn = parseInt(v) || 0;</div><div class="line">		var mn = parseInt(m) || 100;</div><div class="line">		var pc = Math.floor((100 / mn) * vn);</div><div class="line"></div><div class="line">		return String.format(</div><div class="line">			&apos;&lt;div style=&quot;width:200px; position:relative; border:1px solid #999999&quot;&gt;&apos; +</div><div class="line">				&apos;&lt;div style=&quot;background-color:#CCCCCC; width:%d%%; height:15px&quot;&gt;&apos; +</div><div class="line">					&apos;&lt;div style=&quot;position:absolute; left:0; top:0; text-align:center; width:100%%; color:#000000&quot;&gt;&apos; +</div><div class="line">						&apos;&lt;small&gt;%s / %s (%d%%)&lt;/small&gt;&apos; +</div><div class="line">					&apos;&lt;/div&gt;&apos; +</div><div class="line">				&apos;&lt;/div&gt;&apos; +</div><div class="line">			&apos;&lt;/div&gt;&apos;, pc, v, m, pc</div><div class="line">		);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	var wifidevs = null;</div><div class="line">	var arptable = null;</div><div class="line"></div><div class="line">	XHR.poll(5, &apos;/cgi-bin/luci/;stok=d5b2f26bea057631a936bc623259991b&apos;, &#123; status: 1 &#125;,</div><div class="line">		function(x, info)</div><div class="line">		&#123;</div><div class="line">			var si = document.getElementById(&apos;wan4_i&apos;);</div><div class="line">			var ss = document.getElementById(&apos;wan4_s&apos;);</div><div class="line">			var ifc = info.wan;</div><div class="line"></div><div class="line">			if (ifc &amp;&amp; ifc.ifname )</div><div class="line">			&#123;</div><div class="line">				var s = String.format(</div><div class="line">					&apos;&lt;strong&gt;类型: &lt;/strong&gt;%s&lt;br /&gt;&apos; +</div><div class="line">					&apos;&lt;strong&gt;地址: &lt;/strong&gt;%s&lt;br /&gt;&apos; +</div><div class="line">					&apos;&lt;strong&gt;掩码: &lt;/strong&gt;%s&lt;br /&gt;&apos; +</div><div class="line">					&apos;&lt;strong&gt;网关: &lt;/strong&gt;%s&lt;br /&gt;&apos;,</div><div class="line">						ifc.proto,</div><div class="line">						(ifc.ipaddr) ? ifc.ipaddr : &apos;0.0.0.0&apos;,</div><div class="line">						(ifc.netmask &amp;&amp; ifc.netmask != ifc.ipaddr) ? ifc.netmask : &apos;255.255.255.255&apos;,</div><div class="line">						(ifc.gwaddr) ? ifc.gwaddr : &apos;0.0.0.0&apos;</div><div class="line">				);</div><div class="line"></div><div class="line">				for (var i = 0; i &lt; ifc.dns.length; i++)</div><div class="line">				&#123;</div><div class="line">					s += String.format(</div><div class="line">						&apos;&lt;strong&gt;DNS %d: &lt;/strong&gt;%s&lt;br /&gt;&apos;,</div><div class="line">						i + 1, ifc.dns[i]</div><div class="line">					);</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				if (ifc.expires &gt; -1)</div><div class="line">				&#123;</div><div class="line">					s += String.format(</div><div class="line">						&apos;&lt;strong&gt;到期时间: &lt;/strong&gt;%t&lt;br /&gt;&apos;,</div><div class="line">						ifc.expires</div><div class="line">					);</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				if (ifc.uptime &gt; 0)</div><div class="line">				&#123;</div><div class="line">					s += String.format(</div><div class="line">						&apos;&lt;strong&gt;已连接: &lt;/strong&gt;%t&lt;br /&gt;&apos;,</div><div class="line">						ifc.uptime</div><div class="line">					);</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				ss.innerHTML = String.format(&apos;&lt;small&gt;%s&lt;/small&gt;&apos;, s);</div><div class="line">				si.innerHTML = String.format(</div><div class="line">					&apos;&lt;img src=&quot;/luci-static/resources/icons/ethernet.png&quot; /&gt;&apos; +</div><div class="line">					&apos;&lt;br /&gt;&lt;small&gt;&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;&lt;/small&gt;&apos;,</div><div class="line">						ifc.link, ifc.ifname</div><div class="line">				);</div><div class="line">			&#125;</div><div class="line">			else</div><div class="line">			&#123;</div><div class="line">				si.innerHTML = &apos;&lt;img src=&quot;/luci-static/resources/icons/ethernet_disabled.png&quot; /&gt;&lt;br /&gt;&lt;small&gt;?&lt;/small&gt;&apos;;</div><div class="line">				ss.innerHTML = &apos;&lt;em&gt;未连接&lt;/em&gt;&apos;;</div><div class="line">			&#125;</div><div class="line"></div><div class="line"></div><div class="line">			var si6 = document.getElementById(&apos;wan6_i&apos;);</div><div class="line">			var ss6 = document.getElementById(&apos;wan6_s&apos;);</div><div class="line">			var ifc6 = info.wan6;</div><div class="line"></div><div class="line">			if (ifc6 &amp;&amp; ifc6.ifname )</div><div class="line">			&#123;</div><div class="line">				var s = String.format(</div><div class="line">					&apos;&lt;strong&gt;地址: &lt;/strong&gt;%s&lt;br /&gt;&apos; +</div><div class="line">					&apos;&lt;strong&gt;网关: &lt;/strong&gt;%s&lt;br /&gt;&apos;,</div><div class="line">						(ifc6.ip6addr) ? ifc6.ip6addr : &apos;::&apos;,</div><div class="line">						(ifc6.gw6addr) ? ifc6.gw6addr : &apos;::&apos;</div><div class="line">				);</div><div class="line"></div><div class="line">				for (var i = 0; i &lt; ifc6.dns.length; i++)</div><div class="line">				&#123;</div><div class="line">					s += String.format(</div><div class="line">						&apos;&lt;strong&gt;DNS %d: &lt;/strong&gt;%s&lt;br /&gt;&apos;,</div><div class="line">						i + 1, ifc6.dns[i]</div><div class="line">					);</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				if (ifc6.uptime &gt; 0)</div><div class="line">				&#123;</div><div class="line">					s += String.format(</div><div class="line">						&apos;&lt;strong&gt;已连接: &lt;/strong&gt;%t&lt;br /&gt;&apos;,</div><div class="line">						ifc6.uptime</div><div class="line">					);</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				ss6.innerHTML = String.format(&apos;&lt;small&gt;%s&lt;/small&gt;&apos;, s);</div><div class="line">				si6.innerHTML = String.format(</div><div class="line">					&apos;&lt;img src=&quot;/luci-static/resources/icons/ethernet.png&quot; /&gt;&apos; +</div><div class="line">					&apos;&lt;br /&gt;&lt;small&gt;&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;&lt;/small&gt;&apos;,</div><div class="line">						ifc6.link, ifc6.ifname</div><div class="line">				);</div><div class="line">			&#125;</div><div class="line">			else</div><div class="line">			&#123;</div><div class="line">				si6.innerHTML = &apos;&lt;img src=&quot;/luci-static/resources/icons/ethernet_disabled.png&quot; /&gt;&lt;br /&gt;&lt;small&gt;?&lt;/small&gt;&apos;;</div><div class="line">				ss6.innerHTML = &apos;&lt;em&gt;未连接&lt;/em&gt;&apos;;</div><div class="line">			&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">			var ls = document.getElementById(&apos;lease_status_table&apos;);</div><div class="line">			if (ls)</div><div class="line">			&#123;</div><div class="line">				/* clear all rows */</div><div class="line">				while( ls.rows.length &gt; 1 )</div><div class="line">					ls.rows[0].parentNode.deleteRow(1);</div><div class="line"></div><div class="line">				for( var i = 0; i &lt; info.leases.length; i++ )</div><div class="line">				&#123;</div><div class="line">					var timestr;</div><div class="line"></div><div class="line">					if (info.leases[i].expires &lt;= 0)</div><div class="line">						timestr = &apos;&lt;em&gt;过期时间&lt;/em&gt;&apos;;</div><div class="line">					else</div><div class="line">						timestr = String.format(&apos;%t&apos;, info.leases[i].expires);</div><div class="line"></div><div class="line">					var tr = ls.rows[0].parentNode.insertRow(-1);</div><div class="line">						tr.className = &apos;cbi-section-table-row cbi-rowstyle-&apos; + ((i % 2) + 1);</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = info.leases[i].hostname ? info.leases[i].hostname : &apos;?&apos;;</div><div class="line">					tr.insertCell(-1).innerHTML = info.leases[i].ipaddr;</div><div class="line">					tr.insertCell(-1).innerHTML = info.leases[i].macaddr;</div><div class="line">					tr.insertCell(-1).innerHTML = timestr;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				if( ls.rows.length == 1 )</div><div class="line">				&#123;</div><div class="line">					var tr = ls.rows[0].parentNode.insertRow(-1);</div><div class="line">						tr.className = &apos;cbi-section-table-row&apos;;</div><div class="line"></div><div class="line">					var td = tr.insertCell(-1);</div><div class="line">						td.colSpan = 4;</div><div class="line">						td.innerHTML = &apos;&lt;em&gt;&lt;br /&gt;没有已分配的租约。&lt;/em&gt;&apos;;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			var ls6 = document.getElementById(&apos;lease6_status_table&apos;);</div><div class="line">			if (ls6 &amp;&amp; info.leases6)</div><div class="line">			&#123;</div><div class="line">				ls6.parentNode.style.display = &apos;block&apos;;</div><div class="line"></div><div class="line">				/* clear all rows */</div><div class="line">				while( ls6.rows.length &gt; 1 )</div><div class="line">					ls6.rows[0].parentNode.deleteRow(1);</div><div class="line"></div><div class="line">				for( var i = 0; i &lt; info.leases6.length; i++ )</div><div class="line">				&#123;</div><div class="line">					var timestr;</div><div class="line"></div><div class="line">					if (info.leases6[i].expires &lt;= 0)</div><div class="line">						timestr = &apos;&lt;em&gt;过期时间&lt;/em&gt;&apos;;</div><div class="line">					else</div><div class="line">						timestr = String.format(&apos;%t&apos;, info.leases6[i].expires);</div><div class="line"></div><div class="line">					var tr = ls6.rows[0].parentNode.insertRow(-1);</div><div class="line">						tr.className = &apos;cbi-section-table-row cbi-rowstyle-&apos; + ((i % 2) + 1);</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = info.leases6[i].hostname ? info.leases6[i].hostname : &apos;?&apos;;</div><div class="line">					tr.insertCell(-1).innerHTML = info.leases6[i].ip6addr;</div><div class="line">					tr.insertCell(-1).innerHTML = info.leases6[i].duid;</div><div class="line">					tr.insertCell(-1).innerHTML = timestr;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				if( ls6.rows.length == 1 )</div><div class="line">				&#123;</div><div class="line">					var tr = ls6.rows[0].parentNode.insertRow(-1);</div><div class="line">						tr.className = &apos;cbi-section-table-row&apos;;</div><div class="line"></div><div class="line">					var td = tr.insertCell(-1);</div><div class="line">						td.colSpan = 4;</div><div class="line">						td.innerHTML = &apos;&lt;em&gt;&lt;br /&gt;没有已分配的租约。&lt;/em&gt;&apos;;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">			var assoclist = [ ];</div><div class="line"></div><div class="line">			var ws = document.getElementById(&apos;wifi_status_table&apos;);</div><div class="line">			if (ws)</div><div class="line">			&#123;</div><div class="line">				var wsbody = ws.rows[0].parentNode;</div><div class="line">				while (ws.rows.length &gt; 0)</div><div class="line">					wsbody.deleteRow(0);</div><div class="line"></div><div class="line">				for (var didx = 0; didx &lt; info.wifinets.length; didx++)</div><div class="line">				&#123;</div><div class="line">					var dev = info.wifinets[didx];</div><div class="line"></div><div class="line">					var tr = wsbody.insertRow(-1);</div><div class="line">					var td;</div><div class="line"></div><div class="line">					td = tr.insertCell(-1);</div><div class="line">					td.width     = &quot;33%&quot;;</div><div class="line">					td.innerHTML = dev.name;</div><div class="line">					td.style.verticalAlign = &quot;top&quot;;</div><div class="line"></div><div class="line">					td = tr.insertCell(-1);</div><div class="line"></div><div class="line">					var s = &apos;&apos;;</div><div class="line"></div><div class="line">					for (var nidx = 0; nidx &lt; dev.networks.length; nidx++)</div><div class="line">					&#123;</div><div class="line">						var net = dev.networks[nidx];</div><div class="line">						var is_assoc = (net.bssid != &apos;00:00:00:00:00:00&apos; &amp;&amp; net.channel &amp;&amp; !net.disabled);</div><div class="line"></div><div class="line">						var icon;</div><div class="line">						if (!is_assoc)</div><div class="line">							icon = &quot;/luci-static/resources/icons/signal-none.png&quot;;</div><div class="line">						else if (net.quality == 0)</div><div class="line">							icon = &quot;/luci-static/resources/icons/signal-0.png&quot;;</div><div class="line">						else if (net.quality &lt; 25)</div><div class="line">							icon = &quot;/luci-static/resources/icons/signal-0-25.png&quot;;</div><div class="line">						else if (net.quality &lt; 50)</div><div class="line">							icon = &quot;/luci-static/resources/icons/signal-25-50.png&quot;;</div><div class="line">						else if (net.quality &lt; 75)</div><div class="line">							icon = &quot;/luci-static/resources/icons/signal-50-75.png&quot;;</div><div class="line">						else</div><div class="line">							icon = &quot;/luci-static/resources/icons/signal-75-100.png&quot;;</div><div class="line"></div><div class="line">						s += String.format(</div><div class="line">							&apos;&lt;table&gt;&lt;tr&gt;&lt;td style=&quot;text-align:center; width:32px; padding:3px&quot;&gt;&apos; +</div><div class="line">								&apos;&lt;img src=&quot;%s&quot; title=&quot;信号: %d dBm / 噪声: %d dBm&quot; /&gt;&apos; +</div><div class="line">								&apos;&lt;br /&gt;&lt;small&gt;%d%%&lt;/small&gt;&apos; +</div><div class="line">							&apos;&lt;/td&gt;&lt;td style=&quot;text-align:left; padding:3px&quot;&gt;&lt;small&gt;&apos; +</div><div class="line">								&apos;&lt;strong&gt;SSID:&lt;/strong&gt; &lt;a href=&quot;%s&quot;&gt;%h&lt;/a&gt;&lt;br /&gt;&apos; +</div><div class="line">								&apos;&lt;strong&gt;模式:&lt;/strong&gt; %s&lt;br /&gt;&apos; +</div><div class="line">								&apos;&lt;strong&gt;信道:&lt;/strong&gt; %d (%.3f GHz)&lt;br /&gt;&apos; +</div><div class="line">								&apos;&lt;strong&gt;传输速率:&lt;/strong&gt; %s Mbit/s&lt;br /&gt;&apos;,</div><div class="line">								icon, net.signal, net.noise,</div><div class="line">								net.quality,</div><div class="line">								net.link, net.ssid,</div><div class="line">								net.mode,</div><div class="line">								net.channel, net.frequency,</div><div class="line">								net.bitrate || &apos;?&apos;</div><div class="line">						);</div><div class="line"></div><div class="line">						if (is_assoc)</div><div class="line">						&#123;</div><div class="line">							s += String.format(</div><div class="line">								&apos;&lt;strong&gt;BSSID:&lt;/strong&gt; %s&lt;br /&gt;&apos; +</div><div class="line">								&apos;&lt;strong&gt;加密:&lt;/strong&gt; %s&apos;,</div><div class="line">									net.bssid,</div><div class="line">									net.encryption</div><div class="line">							);</div><div class="line">						&#125;</div><div class="line">						else</div><div class="line">						&#123;</div><div class="line">							s += &apos;&lt;em&gt;未开启或未关联无线&lt;/em&gt;&apos;;</div><div class="line">						&#125;</div><div class="line"></div><div class="line">						s += &apos;&lt;/small&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&apos;;</div><div class="line"></div><div class="line">						for (var bssid in net.assoclist)</div><div class="line">						&#123;</div><div class="line">							assoclist.push(&#123;</div><div class="line">								bssid:    bssid,</div><div class="line">								signal:   net.assoclist[bssid].signal,</div><div class="line">								noise:    net.assoclist[bssid].noise,</div><div class="line">								rx_rate:  net.assoclist[bssid].rx_rate,</div><div class="line">								rx_mcs:   net.assoclist[bssid].rx_mcs,</div><div class="line">								rx_40mhz: net.assoclist[bssid].rx_40mhz,</div><div class="line">								tx_rate:  net.assoclist[bssid].tx_rate,</div><div class="line">								tx_mcs:   net.assoclist[bssid].tx_mcs,</div><div class="line">								tx_40mhz: net.assoclist[bssid].tx_40mhz,</div><div class="line">								link:     net.link,</div><div class="line">								name:     net.name</div><div class="line">							&#125;);</div><div class="line">						&#125;</div><div class="line">					&#125;</div><div class="line"></div><div class="line">					if (!s)</div><div class="line">						s = &apos;&lt;em&gt;无可用信息&lt;/em&gt;&apos;;</div><div class="line"></div><div class="line">					td.innerHTML = s;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			var ac = document.getElementById(&apos;wifi_assoc_table&apos;);</div><div class="line">			if (ac)</div><div class="line">			&#123;</div><div class="line">				/* clear all rows */</div><div class="line">				while( ac.rows.length &gt; 1 )</div><div class="line">					ac.rows[0].parentNode.deleteRow(1);</div><div class="line"></div><div class="line">				assoclist.sort(function(a, b) &#123;</div><div class="line">					return (a.name == b.name)</div><div class="line">						? (a.bssid &lt; b.bssid)</div><div class="line">						: (a.name  &gt; b.name )</div><div class="line">					;</div><div class="line">				&#125;);</div><div class="line"></div><div class="line">				for( var i = 0; i &lt; assoclist.length; i++ )</div><div class="line">				&#123;</div><div class="line">					var tr = ac.rows[0].parentNode.insertRow(-1);</div><div class="line">						tr.className = &apos;cbi-section-table-row cbi-rowstyle-&apos; + (1 + (i % 2));</div><div class="line"></div><div class="line">					var icon;</div><div class="line">					var q = (-1 * (assoclist[i].noise - assoclist[i].signal)) / 5;</div><div class="line">					if (q &lt; 1)</div><div class="line">						icon = &quot;/luci-static/resources/icons/signal-0.png&quot;;</div><div class="line">					else if (q &lt; 2)</div><div class="line">						icon = &quot;/luci-static/resources/icons/signal-0-25.png&quot;;</div><div class="line">					else if (q &lt; 3)</div><div class="line">						icon = &quot;/luci-static/resources/icons/signal-25-50.png&quot;;</div><div class="line">					else if (q &lt; 4)</div><div class="line">						icon = &quot;/luci-static/resources/icons/signal-50-75.png&quot;;</div><div class="line">					else</div><div class="line">						icon = &quot;/luci-static/resources/icons/signal-75-100.png&quot;;</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = String.format(</div><div class="line">						&apos;&lt;img src=&quot;%s&quot; title=&quot;信号: %d dBm / 噪声: %d dBm&quot; /&gt;&apos;,</div><div class="line">						icon, assoclist[i].signal, assoclist[i].noise</div><div class="line">					);</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = assoclist[i].bssid;</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = String.format(</div><div class="line">						&apos;&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;&apos;,</div><div class="line">							assoclist[i].link,</div><div class="line">							&apos;%h&apos;.format(assoclist[i].name).nobr()</div><div class="line">					);</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = String.format(&apos;%d dBm&apos;, assoclist[i].signal).nobr();</div><div class="line">					tr.insertCell(-1).innerHTML = String.format(&apos;%d dBm&apos;, assoclist[i].noise).nobr();</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = (assoclist[i].rx_mcs &gt; -1)</div><div class="line">						? String.format(&apos;%.1f Mbit/s, MCS %d, %dMHz&apos;, assoclist[i].rx_rate / 1000, assoclist[i].rx_mcs, assoclist[i].rx_40mhz ? 40 : 20).nobr()</div><div class="line">						: String.format(&apos;%.1f Mbit/s&apos;, assoclist[i].rx_rate / 1000).nobr()</div><div class="line">					;</div><div class="line"></div><div class="line">					tr.insertCell(-1).innerHTML = (assoclist[i].tx_mcs &gt; -1)</div><div class="line">						? String.format(&apos;%.1f Mbit/s, MCS %d, %dMHz&apos;, assoclist[i].tx_rate / 1000, assoclist[i].tx_mcs, assoclist[i].tx_40mhz ? 40 : 20).nobr()</div><div class="line">						: String.format(&apos;%.1f Mbit/s&apos;, assoclist[i].tx_rate / 1000).nobr()</div><div class="line">					;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				if (ac.rows.length == 1)</div><div class="line">				&#123;</div><div class="line">					var tr = ac.rows[0].parentNode.insertRow(-1);</div><div class="line">						tr.className = &apos;cbi-section-table-row&apos;;</div><div class="line"></div><div class="line">					var td = tr.insertCell(-1);</div><div class="line">						td.colSpan = 7;</div><div class="line">						td.innerHTML = &apos;&lt;br /&gt;&lt;em&gt;无可用信息&lt;/em&gt;&apos;;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line"></div><div class="line">			var e;</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;localtime&apos;))</div><div class="line">				e.innerHTML = info.localtime;</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;uptime&apos;))</div><div class="line">				e.innerHTML = String.format(&apos;%t&apos;, info.uptime);</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;loadavg&apos;))</div><div class="line">				e.innerHTML = String.format(</div><div class="line">					&apos;%.02f, %.02f, %.02f&apos;,</div><div class="line">					info.loadavg[0] / 65535.0,</div><div class="line">					info.loadavg[1] / 65535.0,</div><div class="line">					info.loadavg[2] / 65535.0</div><div class="line">				);</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;memtotal&apos;))</div><div class="line">				e.innerHTML = progressbar(</div><div class="line">					((info.memory.free + info.memory.buffered) / 1024) + &quot; kB&quot;,</div><div class="line">					(info.memory.total / 1024) + &quot; kB&quot;</div><div class="line">				);</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;memfree&apos;))</div><div class="line">				e.innerHTML = progressbar(</div><div class="line">					(info.memory.free / 1024) + &quot; kB&quot;,</div><div class="line">					(info.memory.total / 1024) + &quot; kB&quot;</div><div class="line">				);</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;membuff&apos;))</div><div class="line">				e.innerHTML = progressbar(</div><div class="line">					(info.memory.buffered / 1024) + &quot; kB&quot;,</div><div class="line">					(info.memory.total / 1024) + &quot; kB&quot;</div><div class="line">				);</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;swaptotal&apos;))</div><div class="line">				e.innerHTML = progressbar(</div><div class="line">					(info.swap.free / 1024) + &quot; kB&quot;,</div><div class="line">					(info.swap.total / 1024) + &quot; kB&quot;</div><div class="line">				);</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;swapfree&apos;))</div><div class="line">				e.innerHTML = progressbar(</div><div class="line">					(info.swap.free / 1024) + &quot; kB&quot;,</div><div class="line">					(info.swap.total / 1024) + &quot; kB&quot;</div><div class="line">				);</div><div class="line"></div><div class="line">			if (e = document.getElementById(&apos;conns&apos;))</div><div class="line">				e.innerHTML = progressbar(info.conncount, info.connmax);</div><div class="line"></div><div class="line">		&#125;</div><div class="line">	);</div><div class="line">//]]&gt;&lt;/script&gt;</div><div class="line"></div><div class="line">&lt;h2&gt;&lt;a id=&quot;content&quot; name=&quot;content&quot;&gt;状态&lt;/a&gt;&lt;/h2&gt;</div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot;&gt;</div><div class="line">	&lt;legend&gt;系统&lt;/legend&gt;</div><div class="line"></div><div class="line">	&lt;table width=&quot;100%&quot; cellspacing=&quot;10&quot;&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;主机名&lt;/td&gt;&lt;td&gt;NHRT&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;主机型号&lt;/td&gt;&lt;td&gt;NHPT CR5400&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;固件版本&lt;/td&gt;&lt;td&gt;</div><div class="line">			 Cobra  P015C005B025</div><div class="line">		&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;内核版本&lt;/td&gt;&lt;td&gt;3.18.29&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;本地时间&lt;/td&gt;&lt;td id=&quot;localtime&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;运行时间&lt;/td&gt;&lt;td id=&quot;uptime&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;平均负载&lt;/td&gt;&lt;td id=&quot;loadavg&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot;&gt;</div><div class="line">	&lt;legend&gt;内存&lt;/legend&gt;</div><div class="line"></div><div class="line">	&lt;table width=&quot;100%&quot; cellspacing=&quot;10&quot;&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;可用数&lt;/td&gt;&lt;td id=&quot;memtotal&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;空闲数&lt;/td&gt;&lt;td id=&quot;memfree&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;已缓冲&lt;/td&gt;&lt;td id=&quot;membuff&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot;&gt;</div><div class="line">        &lt;legend&gt;4G网络&lt;/legend&gt;</div><div class="line"></div><div class="line">        &lt;table width=&quot;100%&quot; cellspacing=&quot;10&quot;&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;固件版本&lt;/td&gt;&lt;td&gt;10.21.3.14.xw_trk_hk_00.05</div><div class="line">&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;运营商&lt;/td&gt;&lt;td&gt;46000</div><div class="line">&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;注册状态&lt;/td&gt;&lt;td&gt;2,1,11b2,0003,7</div><div class="line">&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;小区信息&lt;/td&gt;&lt;td&gt;PLMN ID:46000,cell ID:418,mode:17,band:38,channel:37900,bandwidth:6,TDD UL/DL configuration:2,RSSI:50,RSRP:34 OK</div><div class="line">&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;RSSI&lt;/td&gt;&lt;td&gt;-104 dBm&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;IMSI&lt;/td&gt;&lt;td&gt;460025111043733</div><div class="line">&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;IP&lt;/td&gt;&lt;td&gt;10.60.114.171</div><div class="line">&lt;/td&gt;&lt;/tr&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;专有承载数&lt;/td&gt;&lt;td&gt;0</div><div class="line">&lt;/td&gt;&lt;/tr&gt;</div><div class="line">        &lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot;&gt;</div><div class="line">	&lt;legend&gt;网络&lt;/legend&gt;</div><div class="line"></div><div class="line">	&lt;table width=&quot;100%&quot; cellspacing=&quot;10&quot;&gt;</div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot; style=&quot;vertical-align:top&quot;&gt;IPv4 WAN状态&lt;/td&gt;&lt;td&gt;</div><div class="line">			&lt;table&gt;&lt;tr&gt;</div><div class="line">				&lt;td id=&quot;wan4_i&quot; style=&quot;width:16px; text-align:center; padding:3px&quot;&gt;&lt;img src=&quot;/luci-static/resources/icons/ethernet_disabled.png&quot; /&gt;&lt;br /&gt;&lt;small&gt;?&lt;/small&gt;&lt;/td&gt;</div><div class="line">				&lt;td id=&quot;wan4_s&quot; style=&quot;vertical-align:middle; padding: 3px&quot;&gt;&lt;em&gt;收集数据：&lt;/em&gt;&lt;/td&gt;</div><div class="line">			&lt;/tr&gt;&lt;/table&gt;</div><div class="line">		&lt;/td&gt;&lt;/tr&gt;</div><div class="line"></div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot; style=&quot;vertical-align:top&quot;&gt;IPv6 WAN状态&lt;/td&gt;&lt;td&gt;</div><div class="line">			&lt;table&gt;&lt;tr&gt;</div><div class="line">				&lt;td id=&quot;wan6_i&quot; style=&quot;width:16px; text-align:center; padding:3px&quot;&gt;&lt;img src=&quot;/luci-static/resources/icons/ethernet_disabled.png&quot; /&gt;&lt;br /&gt;&lt;small&gt;?&lt;/small&gt;&lt;/td&gt;</div><div class="line">				&lt;td id=&quot;wan6_s&quot; style=&quot;vertical-align:middle; padding: 3px&quot;&gt;&lt;em&gt;收集数据：&lt;/em&gt;&lt;/td&gt;</div><div class="line">			&lt;/tr&gt;&lt;/table&gt;</div><div class="line">		&lt;/td&gt;&lt;/tr&gt;</div><div class="line"></div><div class="line">		&lt;tr&gt;&lt;td width=&quot;33%&quot;&gt;活动连接&lt;/td&gt;&lt;td id=&quot;conns&quot;&gt;-&lt;/td&gt;&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot;&gt;</div><div class="line">	&lt;legend&gt;DHCP分配&lt;/legend&gt;</div><div class="line"></div><div class="line">	&lt;table class=&quot;cbi-section-table&quot; id=&quot;lease_status_table&quot;&gt;</div><div class="line">		&lt;tr class=&quot;cbi-section-table-titles&quot;&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;主机名&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;IPv4-地址&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;MAC-地址&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;剩余租期&lt;/th&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr class=&quot;cbi-section-table-row&quot;&gt;</div><div class="line">			&lt;td colspan=&quot;4&quot;&gt;&lt;em&gt;&lt;br /&gt;收集数据：&lt;/em&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot; style=&quot;display:none&quot;&gt;</div><div class="line">	&lt;legend&gt;DHCPv6分配&lt;/legend&gt;</div><div class="line"></div><div class="line">	&lt;table class=&quot;cbi-section-table&quot; id=&quot;lease6_status_table&quot;&gt;</div><div class="line">		&lt;tr class=&quot;cbi-section-table-titles&quot;&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;主机名&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;IPv6-地址&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;DUID（DHCP唯一标识符）&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;剩余租期&lt;/th&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr class=&quot;cbi-section-table-row&quot;&gt;</div><div class="line">			&lt;td colspan=&quot;4&quot;&gt;&lt;em&gt;&lt;br /&gt;收集数据：&lt;/em&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot;&gt;</div><div class="line">	&lt;legend&gt;无线&lt;/legend&gt;</div><div class="line"></div><div class="line">	&lt;table id=&quot;wifi_status_table&quot; width=&quot;100%&quot; cellspacing=&quot;10&quot;&gt;</div><div class="line">		&lt;tr&gt;&lt;td&gt;&lt;em&gt;收集数据：&lt;/em&gt;&lt;/td&gt;&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line"></div><div class="line">&lt;fieldset class=&quot;cbi-section&quot;&gt;</div><div class="line">	&lt;legend&gt;已连接站点&lt;/legend&gt;</div><div class="line"></div><div class="line">	&lt;table class=&quot;cbi-section-table&quot; id=&quot;wifi_assoc_table&quot;&gt;</div><div class="line">		&lt;tr class=&quot;cbi-section-table-titles&quot;&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;&amp;#160;&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;MAC-地址&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;网络&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;信号&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;噪声&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;接收速率&lt;/th&gt;</div><div class="line">			&lt;th class=&quot;cbi-section-table-cell&quot;&gt;发送速率&lt;/th&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">		&lt;tr class=&quot;cbi-section-table-row&quot;&gt;</div><div class="line">			&lt;td colspan=&quot;7&quot;&gt;&lt;em&gt;&lt;br /&gt;收集数据：&lt;/em&gt;&lt;/td&gt;</div><div class="line">		&lt;/tr&gt;</div><div class="line">	&lt;/table&gt;</div><div class="line">&lt;/fieldset&gt;</div><div class="line">&lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;p class=&quot;luci&quot;&gt;</div><div class="line">	&gt;&gt;&gt;&gt;&gt; Cobra  P015C005B025 &gt;&gt;&gt;&gt;&gt;</div><div class="line">&lt;/p&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/19/iOS面试题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/19/iOS面试题/" itemprop="url">iOS面试题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-19T11:53:56+08:00">
                2017-06-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>为提高自己的基础知识水平，最近看了一些笔试相关题目，感觉很多说不清楚和明白，我会在这篇文中中去分享一些面试题和答案，供大家参考，如有错误的地方请大家指正。谢谢！</p>
</blockquote>
<h6 id="什么情况使用-weak-关键字，相比-assign-有什么不同？"><a href="#什么情况使用-weak-关键字，相比-assign-有什么不同？" class="headerlink" title="什么情况使用 weak 关键字，相比 assign 有什么不同？"></a>什么情况使用 weak 关键字，相比 assign 有什么不同？</h6><p>什么情况使用 weak 关键字？<br>在 ARC 中,在有可能出现循环引用的时候,往往要通过让其中一端使用 weak 来解决,比如: delegate 代理属性<br>自身已经对它进行一次强引用,没有必要再强引用一次,此时也会使用 weak,自定义 IBOutlet 控件属性一般也使用 weak；当然，也可以使用strong。<br>不同点：<br>weak 此特质表明该属性定义了一种“非拥有关系” (nonowning relationship)。为这种属性设置新值时，设置方法既不保留新值，也不释放旧值。此特质同assign类似， 然而在属性所指的对象遭到摧毁时，属性值也会清空(nil out)。 而 assign 的“设置方法”只会执行针对“纯量类型” (scalar type，例如 CGFloat 或 NSlnteger 等)的简单赋值操作。<br>assign 可以用非 OC 对象,而 weak 必须用于 OC 对象</p>
<hr>
<h6 id="copy关键字"><a href="#copy关键字" class="headerlink" title="copy关键字"></a>copy关键字</h6><p>1、可变类型使用copy：NSString、NSArray、NSDictionary 等等经常使用copy关键字，是因为他们有对应的可变类型：NSMutableString、NSMutableArray、NSMutableDictionary；</p>
<blockquote>
<p>用 @property 声明 NSString、NSArray、NSDictionary 经常使用 copy 关键字，是因为他们有对应的可变类型：NSMutableString、NSMutableArray、NSMutableDictionary，他们之间可能进行赋值操作，为确保对象中的字符串值不会无意间变动，应该在设置新属性值时拷贝一份。</p>
</blockquote>
<p>2、block使用copy：在 MRC 中,方法内部的 block 是在栈区的,使用 copy 可以把它放到堆区.在 ARC 中写不写都行：对于 block 使用 copy 还是 strong 效果是一样的，编译器自动对 block 进行了 copy 操作。</p>
<hr>
<h6 id="property-copy-NSMutableArray-array有什么问题"><a href="#property-copy-NSMutableArray-array有什么问题" class="headerlink" title="@property (copy) NSMutableArray *array有什么问题"></a><code>@property (copy) NSMutableArray *array</code>有什么问题</h6><p>1、对数组内元素进行修改、删除时，会因为找不到对应的方法而crash。因为 copy 就是复制一个不可变 NSArray 的对象；</p>
<p>2、使用了 atomic(同步锁) 属性会严重影响性能；</p>
<blockquote>
<p>该属性使用了同步锁，会在创建时生成一些额外的代码用于帮助编写多线程程序，这会带来性能问题，通过声明 nonatomic 能够节省这些虽然很小但是不必要额外开销。</p>
</blockquote>
<hr>
<h6 id="如何让自己的类使用copy修饰符，如何重写带copy关键字的属性。"><a href="#如何让自己的类使用copy修饰符，如何重写带copy关键字的属性。" class="headerlink" title="如何让自己的类使用copy修饰符，如何重写带copy关键字的属性。"></a>如何让自己的类使用copy修饰符，如何重写带copy关键字的属性。</h6><p>1、实现使用copy修饰符</p>
<blockquote>
<p>若想令自己所写的对象具有copy功能，则要实现 NSCopying 协议。如果自定义的对象分为可变版本与不可变版本，那么就要同时实现 NSCopying 与 NSMutableCopying 协议</p>
</blockquote>
<p>(1)遵守NSCopying或NSMutableCopying协议<br>(2)实现<code>- (id)copyWithZone:(NSZone *)zone;</code>方法<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">//initWithName方法为类自定义初始化方法</div><div class="line">- (id)copyWithZone:(NSZone *)zone &#123;</div><div class="line">   CYLUser *copy = [[[self class] allocWithZone:zone]</div><div class="line">                    initWithName:_name</div><div class="line">                    age:_age</div><div class="line">                    sex:_sex];</div><div class="line">   copy-&gt;_friends = [_friends mutableCopy];</div><div class="line">   return copy;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//在例子中，存放朋友对象的 set 是用 “copyWithZone:” 方法来拷贝的，这种浅拷贝方式不会逐个复制 set 中的元素。若需要深拷贝的话，则可像下面这样，编写一个专供深拷贝所用的方法:</div><div class="line">- (id)deepCopy &#123;</div><div class="line">   CYLUser *copy = [[[self class] alloc]</div><div class="line">                    initWithName:_name</div><div class="line">                    age:_age</div><div class="line">                    sex:_sex];</div><div class="line">   copy-&gt;_friends = [[NSMutableSet alloc] initWithSet:_friends</div><div class="line">                                            copyItems:YES];</div><div class="line">   return copy;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2、重写带copy关键字的属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (void)setName:(NSString *)name &#123;</div><div class="line">   if (_name != name) &#123;</div><div class="line">       //[_name release];//MRC</div><div class="line">       _name = [name copy];</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h6 id="协议-protocol-和类别-categories-中如何使用-property"><a href="#协议-protocol-和类别-categories-中如何使用-property" class="headerlink" title="协议(@protocol)和类别(categories)中如何使用@property"></a>协议(@protocol)和类别(categories)中如何使用@property</h6><p>1、在 protocol 中使用 property 只会生成 setter 和 getter 方法声明,我们使用属性的目的,是希望遵守我协议的对象能实现该属性。<br>2、category 使用 @property 也是只会生成 setter 和 getter 方法的声明,如果我们真的需要给 category 增加属性的实现,需要借助于runtime的两个函数<code>objc_setAssociatedObject/objc_getAssociatedObject</code>。</p>
<hr>
<h6 id="runtim是如何实现weak属性"><a href="#runtim是如何实现weak属性" class="headerlink" title="runtim是如何实现weak属性"></a>runtim是如何实现weak属性</h6><p>weak属性特点：</p>
<blockquote>
<p>weak 此特质表明该属性定义了一种“非拥有关系” (nonowning relationship)。为这种属性设置新值时，设置方法既不保留新值，也不释放旧值。此特质同 assign 类似， 然而在属性所指的对象遭到摧毁时，属性值也会清空(nil out)。</p>
</blockquote>
<p>如何实现：</p>
<blockquote>
<p>runtime 对注册的类， 会进行布局，对于 weak 对象会放入一个 hash 表中。 用 weak 指向的对象内存地址作为 key，当此对象的引用计数为0的时候会 dealloc，假如 weak 指向的对象内存地址是a，那么就会以a为键， 在这个 weak 表中搜索，找到所有以a为键的 weak 对象，从而设置为 nil。</p>
</blockquote>
<hr>
<h6 id="property中有哪些属性关键字，和其意义。"><a href="#property中有哪些属性关键字，和其意义。" class="headerlink" title="@property中有哪些属性关键字，和其意义。"></a>@property中有哪些属性关键字，和其意义。<br></h6><p>1、原子性— nonatomic 特质</p>
<blockquote>
<p>在默认情况下，由编译器合成的方法会通过锁定机制确保其原子性(atomicity)。如果属性具备 nonatomic 特质，则不使用自旋锁。请注意，尽管没有名为“atomic”的特质(如果某属性不具备 nonatomic 特质，那它就是“原子的” ( atomic) )，但是仍然可以在属性特质中写明这一点，编译器不会报错。若是自己定义存取方法，那么就应该遵从与属性特质相符的原子性。</p>
</blockquote>
<p>2、读/写权限—readwrite(读写)、readonly (只读)  <br><br>3、内存管理语义—assign、strong、 weak、unsafe_unretained、copy  <br><br>4、方法名—<code>getter=&lt;name&gt;  setter=&lt;name&gt;
@property样式：@property (nonatomic, getter=isOn) BOOL on;</code></p>
<hr>
<h6 id="weak属性需要在dealloc中置nil么？"><a href="#weak属性需要在dealloc中置nil么？" class="headerlink" title="weak属性需要在dealloc中置nil么？"></a>weak属性需要在dealloc中置nil么？</h6><p>不需要。</p>
<blockquote>
<p>在ARC环境无论是强指针还是弱指针都无需在 dealloc 设置为 nil ， ARC 会自动帮我们处理<br>即便是编译器不帮我们做这些，weak也不需要在 dealloc 中置nil</p>
</blockquote>
<hr>
<h6 id="synthesize和-dynamic分别有什么作用？"><a href="#synthesize和-dynamic分别有什么作用？" class="headerlink" title="@synthesize和@dynamic分别有什么作用？"></a>@synthesize和@dynamic分别有什么作用？</h6><p>1、@property有两个对应的词，一个是 @synthesize，一个是 @dynamic。如果 @synthesize和 @dynamic都没写，那么默认的就是<code>@syntheszie var = _var;</code>。<br><br>2、@synthesize 的语义是如果你没有手动实现 setter 方法和 getter 方法，那么编译器会自动为你加上这两个方法。<br><br>3、@dynamic 告诉编译器：属性的 setter 与 getter 方法由用户自己实现，不自动生成。（当然对于 readonly 的属性只需提供 getter 即可）。假如一个属性被声明为 @dynamic var，然后你没有提供 @setter方法和 @getter 方法，编译的时候没问题，但是当程序运行到 <code>instance.var = someVar</code>,由于缺 setter 方法会导致程序崩溃；或者当运行到 <code>someVar = var</code> 时，由于缺 getter 方法同样会导致崩溃。编译时没问题，运行时才执行相应的方法，这就是所谓的动态绑定。</p>
<hr>
<h6 id="ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？"><a href="#ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？" class="headerlink" title="ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？"></a>ARC下，不显式指定任何属性关键字时，默认的关键字都有哪些？</h6><p>1、对应基本数据类型默认关键字是atomic,readwrite,assign  <br><br>2、对于普通的 Objective-C 对象atomic,readwrite,strong</p>
<hr>
<h6 id="用-property声明的NSString（或NSArray，NSDictionary）经常使用copy关键字，为什么？如果改用strong关键字，可能造成什么问题？"><a href="#用-property声明的NSString（或NSArray，NSDictionary）经常使用copy关键字，为什么？如果改用strong关键字，可能造成什么问题？" class="headerlink" title="用@property声明的NSString（或NSArray，NSDictionary）经常使用copy关键字，为什么？如果改用strong关键字，可能造成什么问题？"></a>用@property声明的NSString（或NSArray，NSDictionary）经常使用copy关键字，为什么？如果改用strong关键字，可能造成什么问题？</h6><p>1、因为父类指针可以指向子类对象,使用 copy 的目的是为了让本对象的属性不受外界影响,使用 copy 无论给我传入是一个可变对象还是不可对象,我本身持有的就是一个不可变的副本. <br><br>2、如果我们使用是 strong ,那么这个属性就有可能指向一个可变对象,如果这个可变对象在外部被修改了,那么会影响该属性.</p>
<blockquote>
<p>copy 此特质所表达的所属关系与 strong 类似。然而设置方法并不保留新值，而是将其“拷贝” (copy)。 当属性类型为 NSString 时，经常用此特质来保护其封装性，因为传递给设置方法的新值有可能指向一个 NSMutableString 类的实例。这个类是 NSString 的子类，表示一种可修改其值的字符串，此时若是不拷贝字符串，那么设置完属性之后，字符串的值就可能会在对象不知情的情况下遭人更改。所以，这时就要拷贝一份“不可变” (immutable)的字符串，确保对象中的字符串值不会无意间变动。只要实现属性所用的对象是“可变的” (mutable)，就应该在设置新属性值时拷贝一份。</p>
</blockquote>
<p>为了理解这种做法，首先要知道，两种情况：</p>
<blockquote>
<p>在非集合类对象中：对 immutable 对象进行 copy 操作，是指针复制，mutableCopy 操作时内容复制；对 mutable 对象进行 copy 和 mutableCopy 都是内容复制。用代码简单表示如下：<br>[immutableObject copy] // 浅复制<br>[immutableObject mutableCopy] //深复制<br>[mutableObject copy] //深复制<br>[mutableObject mutableCopy] //深复制</p>
<p>集合类对象的copy和mutableCopy<br>[immutableObject copy] // 浅复制<br>[immutableObject mutableCopy] //单层深复制<br>[mutableObject copy] //单层深复制<br>[mutableObject mutableCopy] //单层深复制</p>
<hr>
</blockquote>
<h6 id="synthesize合成实例变量的规则是什么？假如property名为foo，存在一个名为-foo的实例变量，那么还会自动合成新变量么？"><a href="#synthesize合成实例变量的规则是什么？假如property名为foo，存在一个名为-foo的实例变量，那么还会自动合成新变量么？" class="headerlink" title="@synthesize合成实例变量的规则是什么？假如property名为foo，存在一个名为_foo的实例变量，那么还会自动合成新变量么？"></a>@synthesize合成实例变量的规则是什么？假如property名为foo，存在一个名为_foo的实例变量，那么还会自动合成新变量么？</h6><p>不会，存在_foo了就不会自动创建变量了。</p>
<hr>
<h6 id="objc中向一个nil对象发送消息将会发生什么？"><a href="#objc中向一个nil对象发送消息将会发生什么？" class="headerlink" title="objc中向一个nil对象发送消息将会发生什么？"></a>objc中向一个nil对象发送消息将会发生什么？</h6><p>在 Objective-C 中向 nil 发送消息是完全有效的——只是在运行时不会有任何作用。 <br></p>
<blockquote>
<p>objc是动态语言，每个方法在运行时会被动态转为消息发送，即：objc_msgSend(receiver, selector)。</p>
</blockquote>
<p>objc在向一个对象发送消息时，runtime库会根据对象的isa指针找到该对象实际所属的类，然后在该类中的方法列表以及其父类方法列表中寻找方法运行，然后在发送消息的时候，objc_msgSend方法不会返回值，所谓的返回内容都是具体调用时执行的。 那么，回到本题，如果向一个nil对象发送消息，首先在寻找对象的isa指针时就是0地址返回了，所以不会出现任何错误。</p>
<hr>
<h6 id="对象的内存销毁时间表"><a href="#对象的内存销毁时间表" class="headerlink" title="对象的内存销毁时间表"></a>对象的内存销毁时间表</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// 对象的内存销毁时间表 wwdc 2011</div><div class="line"> 1. 调用 -release ：引用计数变为零</div><div class="line">     * 对象正在被销毁，生命周期即将结束.</div><div class="line">     * 不能再有新的 __weak 弱引用， 否则将指向 nil.</div><div class="line">     * 调用 [self dealloc]</div><div class="line"> 2. 子类 调用 -dealloc</div><div class="line">     * 继承关系中最底层的子类 在调用 -dealloc</div><div class="line">     * 如果是 MRC 代码 则会手动释放实例变量们（iVars）</div><div class="line">     * 继承关系中每一层的父类 都在调用 -dealloc</div><div class="line"> 3. NSObject 调 -dealloc</div><div class="line">     * 只做一件事：调用 Objective-C runtime 中的 object_dispose() 方法</div><div class="line"> 4. 调用 object_dispose()</div><div class="line">     * 为 C++ 的实例变量们（iVars）调用 destructors</div><div class="line">     * 为 ARC 状态下的 实例变量们（iVars） 调用 -release</div><div class="line">     * 解除所有使用 runtime Associate方法关联的对象</div><div class="line">     * 解除所有 __weak 引用</div><div class="line">     * 调用 free()</div></pre></td></tr></table></figure>
<hr>
<h6 id="objc中的类方法和实例方法有什么本质区别和联系？"><a href="#objc中的类方法和实例方法有什么本质区别和联系？" class="headerlink" title="objc中的类方法和实例方法有什么本质区别和联系？"></a>objc中的类方法和实例方法有什么本质区别和联系？</h6><ul>
<li>类方法：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">类方法是属于类对象的</div><div class="line">类方法只能通过类对象调用</div><div class="line">类方法中的self是类对象</div><div class="line">类方法可以调用其他的类方法</div><div class="line">类方法中不能访问成员变量</div><div class="line">类方法中不能直接调用对象方法</div></pre></td></tr></table></figure>
<ul>
<li>实例方法：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">实例方法是属于实例对象的</div><div class="line">实例方法只能通过实例对象调用</div><div class="line">实例方法中的self是实例对象</div><div class="line">实例方法中可以访问成员变量</div><div class="line">实例方法中直接调用实例方法</div><div class="line">实例方法中也可以调用类方法(通过类名)</div></pre></td></tr></table></figure>
<hr>
<p>今天先到这吧，项目工作还是比较繁忙的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/13/python网络爬虫/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/13/python网络爬虫/" itemprop="url">python网络爬虫</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-13T14:28:07+08:00">
                2017-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>最近在简书上浏览博客时发现有人用爬虫历时30个小时拿到简书大约30万用户的活跃情况，我大为吃惊呀。先前也了解了一下关于爬虫方面的东西，但过于零碎没有形成系统体系。今日我新增这篇博客来记录我学习爬虫已经应用Python编写简单爬虫的过程和个人的一些总结，仅供大家参考，同时发布在简书平台上。我的用户名叫“靠北”，如想共同进步，请联系我。</p>
<p>附：学习视频地址：<a href="http://www.imooc.com/learn/563" target="_blank" rel="external">http://www.imooc.com/learn/563</a>   课程可能稍有难度，建议先学习基本的Python语法、函数及正则表达式等。</p>
</blockquote>
<ul>
<li>爬虫的简介<blockquote>
<p>爬虫技术用来从互联网上自动获取需要的数据。</p>
</blockquote>
</li>
</ul>
<p>我的理解是：爬虫是根据编写好的代码自动去执行人类工作，爬虫可以几乎能爬到人类能打开的所有网页，并根据预先设置的存储路径将需要的数据进行本地化存储，供后续使用和研究。网络搜索引擎就是一个巨大的爬虫系统。</p>
<p>。。。。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/06/iOS开发中工具类（方法）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/06/iOS开发中工具类（方法）/" itemprop="url">iOS开发中工具类（方法）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-06T16:04:47+08:00">
                2017-06-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>本文章主要我在实际开发过程中常用到的一些方法或函数，未来类似功能可以直接调用或者修改即可使用。本篇将长期更新。<br></p>
<p>目录</p>
</blockquote>
<ul>
<li>UIGraphicsBeginImageContext消除锯齿</li>
<li>iOS线程</li>
<li>UIbutton图片和文字默认偏移（上下）</li>
<li>判断设置是否越狱</li>
<li>判断是否是数字</li>
<li>判断是否是字符（a-z）</li>
<li>获取当前任务占用的内存</li>
<li>获取中英文混合字符串的长度</li>
<li>获取字节长度</li>
<li>获取app的沙盒路径</li>
<li>为Button绘制背景图片</li>
<li>判断空字符串</li>
<li>判断单个文件大小</li>
<li>获取视频第一帧</li>
<li>获取系统字体</li>
<li>比对与当前时间的天数差</li>
<li>色值转换（#2324512z转UIColor）</li>
<li>通过颜色设置图片</li>
<li>通过颜色设置图片（有高度）</li>
<li>将图片转换为黑白</li>
<li>缓存图片到本地  (注意：需要指定缓存路径，获取到本地沙盒路径等)。</li>
<li>图片裁剪（传入Rect）</li>
<li>按尺寸压缩图片</li>
<li>UIImage两种加载方式比较</li>
</ul>
<hr>
<blockquote>
<p>ARC &amp;&amp; MRC 使用</p>
</blockquote>
<ul>
<li>ARC环境中引入MRC文件  加入<code>-fno-objc-arc</code><br></li>
<li>MRC环境引入ARC文件，加入：<code>-fobjc-arc</code></li>
</ul>
<hr>
<ul>
<li>UIGraphicsBeginImageContext消除锯齿<br>最近在做连线的时候发现，斜线会有锯齿存在。查阅资料发现是像素点原因引起，以下只是简单解决的一种方式，有一定效果但不全面。仅做记录。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//方法1</div><div class="line">view.layer.contentsScale = [[UIScreen mainScreen] scale];</div><div class="line"></div><div class="line">//方法2</div><div class="line">CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">CGContextSetAllowsAntialiasing(context,true);//开启自动去锯齿</div><div class="line">CGContextSetShouldAntialias(context, true);</div></pre></td></tr></table></figure>
<ul>
<li>iOS线程<blockquote>
<p>一般来说，队列可分为两种类型：串行和并行。也可以分为系统队列和用户队列两种</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>串行：<br>dispatch_get_main_queue() 主线程队列，在主线程中执行<br>dispatch_queue_create(DISPATCH_QUEUE_SERIAL) 自定义串行队列<br>并行：<br>dispatch_get_global_queue() 由系统维护的并行队列<br>dispatch_queue_create(DISPATCH_QUEUE_CONCURRENT) 自定义并发队列</p>
<p>This function is the fundamental mechanism for submitting blocks to a dispatch queue. Calls to this function always return immediately after the block has been submitted and never wait for the block to be invoked. The target queue determines whether the block is invoked serially or concurrently with respect to other blocks submitted to that same queue. Independent serial queues are processed concurrently with respect to each other.</p>
<p>该函数为向dispatch队列中提交block对象的最基础的机制。调用这个接口后将block提交后会马上返回，并不会等待block被调用。参数queue决定block对象是被串行执行还是并行执行。不同的串行队列将被并行处理。</p>
</blockquote>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//在主线程执行一个block</div><div class="line">  dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">      NSLog(@&quot;invoke in main thread.&quot;);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">  //异步执行一个block</div><div class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">        NSLog(@&quot;invoke in another thread which is in system thread pool.&quot;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<ul>
<li>UIbutton图片和文字默认偏移（上下）<br>注意：传入需要设置的Button和文字和图片之间的垂直距离即可。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">+ (void)setButtonImageAndTitleVerticalCenterWithSpace:(CGFloat)space button:(UIButton *)button</div><div class="line">&#123;</div><div class="line">    CGSize imageSize = button.imageView.frame.size;</div><div class="line">    CGSize titleSize = [button.titleLabel.text sizeWithAttributes:@&#123;NSFontAttributeName:[UIFont systemFontOfSize:12]&#125;];</div><div class="line">    CGFloat totalHeight = (imageSize.height + titleSize.height + space);</div><div class="line">    button.imageEdgeInsets = UIEdgeInsetsMake(- (totalHeight - imageSize.height), 0.0, 0.0, - titleSize.width);</div><div class="line">    button.titleEdgeInsets = UIEdgeInsetsMake(0.0, - imageSize.width, - (totalHeight - titleSize.height),0.0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断设置是否越狱</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)isJailbroken &#123;</div><div class="line">    BOOL jailbroken = NO;</div><div class="line">    NSString *cydiaPath = @&quot;/Applications/Cydia.app&quot;;</div><div class="line">    NSString *aptPath = @&quot;/private/var/lib/apt/&quot;;</div><div class="line">    if ([[NSFileManager defaultManager] fileExistsAtPath:cydiaPath]) &#123;</div><div class="line">        jailbroken = YES;</div><div class="line">    &#125;</div><div class="line">    if ([[NSFileManager defaultManager] fileExistsAtPath:aptPath]) &#123;</div><div class="line">        jailbroken = YES;</div><div class="line">    &#125;</div><div class="line">    return jailbroken;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断是否是数字</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (BOOL) validateNumber: (NSString *) number&#123;</div><div class="line">    NSString *reg = @&quot;^[0-9]*$&quot;;</div><div class="line">    NSPredicate *numberTest = [NSPredicate predicateWithFormat:@&quot;SELF MATCHES %@&quot;, reg];</div><div class="line">    return [numberTest evaluateWithObject:number];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断是否是字符（a-z）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)validata:(NSString *)number&#123;</div><div class="line">    NSString *regex = @&quot;[A-Za-z]+&quot;;</div><div class="line">    NSPredicate *numberTest = [NSPredicate predicateWithFormat:@&quot;SELF MATCHES %@&quot;, regex];</div><div class="line">    return [numberTest evaluateWithObject:number];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取当前任务占用的内存</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">+ (double)usedMemory</div><div class="line">&#123;</div><div class="line">    task_basic_info_data_t taskInfo;</div><div class="line">    mach_msg_type_number_t infoCount = TASK_BASIC_INFO_COUNT;</div><div class="line">    kern_return_t kernReturn = task_info(mach_task_self(),</div><div class="line">                                         TASK_BASIC_INFO, (task_info_t)&amp;taskInfo, &amp;infoCount);</div><div class="line">    if(kernReturn != KERN_SUCCESS) &#123;</div><div class="line">        return NSNotFound;</div><div class="line">    &#125;</div><div class="line">    return taskInfo.resident_size / 1024.0 / 1024.0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取中英文混合字符串的长度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">+ (int)convertToInt:(NSString*)strtemp</div><div class="line">&#123;</div><div class="line">    int strlength = 0;</div><div class="line">    char* p = (char*)[strtemp cStringUsingEncoding:NSUnicodeStringEncoding];</div><div class="line">    for (int i=0 ; i&lt;[strtemp lengthOfBytesUsingEncoding:NSUnicodeStringEncoding] ;i++) &#123;</div><div class="line">        if (*p) &#123;</div><div class="line">            p++;</div><div class="line">            strlength++;</div><div class="line">        &#125;</div><div class="line">        else &#123;</div><div class="line">            p++;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return strlength;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取字节长度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">+(NSUInteger) unicodeLengthOfString: (NSString *) text &#123;</div><div class="line">    NSUInteger asciiLength = 0;</div><div class="line"></div><div class="line">    for (NSUInteger i = 0; i &lt; text.length; i++) &#123;</div><div class="line">        unichar uc = [text characterAtIndex: i];</div><div class="line">        asciiLength += isascii(uc) ? 1 : 2;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    NSUInteger unicodeLength = asciiLength / 2;</div><div class="line"></div><div class="line">    if(asciiLength % 2) &#123;</div><div class="line">        unicodeLength++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return unicodeLength;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取app的沙盒路径</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">+ (NSString *)documentPath</div><div class="line">&#123;</div><div class="line">    // 获取应用程序沙盒的Documents目录</div><div class="line">    NSArray *paths=NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES);</div><div class="line">    return [paths objectAtIndex:0];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>为Button绘制背景图片</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">+ (void)backgroundTurnRedForButton:(UIButton *)button red:(CGFloat)red green:(CGFloat)green blue:(CGFloat)blue alpha:(CGFloat)alpha  type:(int) type&#123;</div><div class="line">    CGSize size = button.frame.size;</div><div class="line">    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, size.width, size.height)];</div><div class="line">    view.layer.cornerRadius = 6;</div><div class="line">    view.clipsToBounds = true;</div><div class="line">    view.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:alpha];</div><div class="line">    UIGraphicsBeginImageContext(size);</div><div class="line">    [view.layer renderInContext:UIGraphicsGetCurrentContext()];</div><div class="line"></div><div class="line">    UIImage *screenImage = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line">    switch (type) &#123;</div><div class="line">        case 0:</div><div class="line">            [button setBackgroundImage:screenImage forState:UIControlStateNormal];</div><div class="line">            break;</div><div class="line">        case 1:</div><div class="line">            [button setBackgroundImage:screenImage forState:UIControlStateHighlighted];</div><div class="line">            break;</div><div class="line">        default:</div><div class="line">            break;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断空字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">+(BOOL) isEmptyOrNull:(NSString *) str &#123;</div><div class="line">    if (!str) &#123;</div><div class="line">        // null object</div><div class="line">        return YES;</div><div class="line">    &#125; else &#123;</div><div class="line">        NSString *trimedString = [str stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];</div><div class="line">        if ([trimedString length] == 0) &#123;</div><div class="line">            // empty string</div><div class="line">            return YES;</div><div class="line">        &#125; else &#123;</div><div class="line">            // is neither empty nor null</div><div class="line">            return NO;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断单个文件大小</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+(long long)fileSizeAtPath:(NSString*)filePath&#123;</div><div class="line">    NSFileManager* manager = [NSFileManager defaultManager];</div><div class="line">    if ([manager fileExistsAtPath:filePath])&#123;</div><div class="line">        return [[manager attributesOfItemAtPath:filePath error:nil] fileSize];</div><div class="line">    &#125;</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取视频第一帧</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">+(UIImage *)getPreViewImg:(NSString *)url</div><div class="line">&#123;</div><div class="line">    UIImage *img = nil;</div><div class="line">    @autoreleasepool &#123;</div><div class="line">        NSURL *urlvideo = nil;</div><div class="line"></div><div class="line">        if([url hasPrefix:@&quot;assets-library:&quot;] ) &#123;</div><div class="line">            urlvideo = [NSURL URLWithString:url];</div><div class="line">        &#125;else&#123;</div><div class="line">            urlvideo = [[NSURL alloc]initFileURLWithPath:url];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        AVURLAsset *asset = [[AVURLAsset alloc] initWithURL:urlvideo options:nil];</div><div class="line">        AVAssetImageGenerator *gen = [[AVAssetImageGenerator alloc] initWithAsset:asset];</div><div class="line">        gen.appliesPreferredTrackTransform = YES;</div><div class="line">        CMTime time = CMTimeMakeWithSeconds(0.0, 600);</div><div class="line">        NSError *error = nil;</div><div class="line">        CMTime actualTime;</div><div class="line">        CGImageRef image = [gen copyCGImageAtTime:time actualTime:&amp;actualTime error:&amp;error];</div><div class="line">        img = [[UIImage alloc] initWithCGImage:image];</div><div class="line">        CGImageRelease(image);</div><div class="line">    &#125;</div><div class="line">    return img;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取本机IP</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">+ (NSString *)getIPAddress</div><div class="line">&#123;</div><div class="line"></div><div class="line">    NSString *address = @&quot;error&quot;;</div><div class="line">    struct ifaddrs *interfaces = NULL;</div><div class="line">    struct ifaddrs *temp_addr = NULL;</div><div class="line">    int success = 0;</div><div class="line"></div><div class="line">    // retrieve the current interfaces - returns 0 on success</div><div class="line">    success = getifaddrs(&amp;interfaces);</div><div class="line">    if (success == 0) &#123;</div><div class="line">        // Loop through linked list of interfaces</div><div class="line">        temp_addr = interfaces;</div><div class="line">        while (temp_addr != NULL) &#123;</div><div class="line">            if( temp_addr-&gt;ifa_addr-&gt;sa_family == AF_INET) &#123;</div><div class="line">                // Check if interface is en0 which is the wifi connection on the iPhone</div><div class="line">                if ([[NSString stringWithUTF8String:temp_addr-&gt;ifa_name] isEqualToString:@&quot;en0&quot;]) &#123;</div><div class="line">                    // Get NSString from C String</div><div class="line">                    address = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            temp_addr = temp_addr-&gt;ifa_next;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Free memory</div><div class="line">    freeifaddrs(interfaces);</div><div class="line"></div><div class="line">    return address;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取系统字体</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">+ (UIFont*)getCurrentFont</div><div class="line">&#123;</div><div class="line">    //判断系统字体的size，返回使用的字体。</div><div class="line">    UIFont *font = [UIFont systemFontOfSize:[UIFont systemFontSize]];</div><div class="line">    return font;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>比对与当前时间的天数差</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">*</div><div class="line"> *对比两个时间</div><div class="line"> *date:需要跟当前时间对比的时间</div><div class="line"> */</div><div class="line">+ (int)getTimedif:(NSDate*)date</div><div class="line">&#123;</div><div class="line">    int num = 0;</div><div class="line">    if (!date) &#123;</div><div class="line">        return num;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    NSCalendar *calendar = [NSCalendar currentCalendar];</div><div class="line">    NSDateComponents *components = [calendar components:NSDayCalendarUnit|NSHourCalendarUnit|NSMinuteCalendarUnit fromDate:[NSDate date]];</div><div class="line">    NSDateComponents *dtComponents = [calendar components:NSDayCalendarUnit|NSHourCalendarUnit|NSMinuteCalendarUnit fromDate:date];</div><div class="line">    num = [components day] - [dtComponents day];</div><div class="line">    return num;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>颜色</p>
</blockquote>
<ul>
<li>色值转换（#2324512z转UIColor）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">+ (UIColor *)hexString:(NSString *)hex&#123;</div><div class="line">    hex = [hex stringByReplacingOccurrencesOfString:@&quot;#&quot; withString:@&quot;&quot;];</div><div class="line">    if (hex.length&lt;6) &#123;</div><div class="line">        return nil;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    unsigned int r,g,b;</div><div class="line">    NSRange stringRange;</div><div class="line"></div><div class="line">    stringRange.length = 2;</div><div class="line">    stringRange.location = 0;</div><div class="line">    [[NSScanner scannerWithString:[hex substringWithRange:stringRange]] scanHexInt:&amp;r];</div><div class="line"></div><div class="line">    stringRange.location = 2;</div><div class="line">    [[NSScanner scannerWithString:[hex substringWithRange:stringRange]] scanHexInt:&amp;g];</div><div class="line"></div><div class="line">    stringRange.location = 4;</div><div class="line">    [[NSScanner scannerWithString:[hex substringWithRange:stringRange]] scanHexInt:&amp;b];</div><div class="line"></div><div class="line">	float fr = (r * 1.0f) / 255.0f;</div><div class="line">	float fg = (g * 1.0f) / 255.0f;</div><div class="line">	float fb = (b * 1.0f) / 255.0f;</div><div class="line"></div><div class="line">	return [UIColor colorWithRed:fr green:fg blue:fb alpha:1.0f];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>通过颜色设置图片</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (UIImage *)createImageWithColor:(UIColor *)color</div><div class="line">&#123;</div><div class="line">    CGRect rect = CGRectMake(0.0f, 0.0f, 1.0f, 1.0f);</div><div class="line">    UIGraphicsBeginImageContext(rect.size);</div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">    CGContextSetFillColorWithColor(context, [color CGColor]);</div><div class="line">    CGContextFillRect(context, rect);</div><div class="line">    UIImage *theImage = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line"></div><div class="line">    return theImage;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>通过颜色设置图片（有高度）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (UIImage*) GetImageWithColor:(UIColor*)color andHeight:(CGFloat)height</div><div class="line">&#123;</div><div class="line">    CGRect r= CGRectMake(0.0f, 0.0f, 1.0f, height);</div><div class="line">    UIGraphicsBeginImageContext(r.size);</div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">    CGContextSetFillColorWithColor(context, [color CGColor]);</div><div class="line">    CGContextFillRect(context, r);</div><div class="line">    UIImage *img = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line">    return img;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>图片处理</p>
</blockquote>
<ul>
<li>裁剪图片为圆形</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">+(UIImage*) circleImage:(UIImage*) image withParam:(CGFloat) inset &#123;</div><div class="line">    UIGraphicsBeginImageContext(image.size);</div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">    CGContextSetLineWidth(context, 20);</div><div class="line">    CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);</div><div class="line">    CGRect rect = CGRectMake(inset, inset, image.size.width - inset * 2.0f, image.size.height - inset * 2.0f);</div><div class="line">    CGContextAddEllipseInRect(context, rect);</div><div class="line">    CGContextClip(context);</div><div class="line"></div><div class="line">    [image drawInRect:rect];</div><div class="line">    CGContextAddEllipseInRect(context, rect);</div><div class="line">    CGContextStrokePath(context);</div><div class="line">    UIImage *newimg = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line">    return newimg;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>为图片添加圆角显示</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">//给图片添加圆角显示</div><div class="line">+ (UIImage *) roundCorners: (UIImage*) img</div><div class="line">&#123;</div><div class="line">    int w = img.size.width;</div><div class="line">    int h = img.size.height;</div><div class="line"></div><div class="line">    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();</div><div class="line">    CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 * w, colorSpace, kCGImageAlphaPremultipliedFirst);</div><div class="line"></div><div class="line">    CGContextBeginPath(context);</div><div class="line">    CGRect rect = CGRectMake(0, 0, img.size.width, img.size.height);</div><div class="line">    addRoundedRectToPath(context, rect, 10, 10);</div><div class="line">    CGContextClosePath(context);</div><div class="line">    CGContextClip(context);</div><div class="line"></div><div class="line">    CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);</div><div class="line"></div><div class="line">    CGImageRef imageMasked = CGBitmapContextCreateImage(context);</div><div class="line">    CGContextRelease(context);</div><div class="line">    CGColorSpaceRelease(colorSpace);</div><div class="line">    UIImage *images = [UIImage imageWithCGImage:imageMasked];</div><div class="line">    CGImageRelease(imageMasked);</div><div class="line">    return images;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>将图片转换为黑白</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">+ (UIImage*)blackAndWhitePhoto:(UIImage*)anImage</div><div class="line">&#123;</div><div class="line"></div><div class="line">    CGImageRef imageRef = anImage.CGImage;</div><div class="line"></div><div class="line">    size_t width  = CGImageGetWidth(imageRef);</div><div class="line">    size_t height = CGImageGetHeight(imageRef);</div><div class="line"></div><div class="line">    size_t bitsPerComponent = CGImageGetBitsPerComponent(imageRef);</div><div class="line">    size_t bitsPerPixel = CGImageGetBitsPerPixel(imageRef);</div><div class="line"></div><div class="line">    size_t bytesPerRow = CGImageGetBytesPerRow(imageRef);</div><div class="line"></div><div class="line">    CGColorSpaceRef colorSpace = CGImageGetColorSpace(imageRef);</div><div class="line"></div><div class="line">    CGBitmapInfo bitmapInfo = CGImageGetBitmapInfo(imageRef);</div><div class="line"></div><div class="line"></div><div class="line">    bool shouldInterpolate = CGImageGetShouldInterpolate(imageRef);</div><div class="line"></div><div class="line">    CGColorRenderingIntent intent = CGImageGetRenderingIntent(imageRef);</div><div class="line"></div><div class="line">    CGDataProviderRef dataProvider = CGImageGetDataProvider(imageRef);</div><div class="line"></div><div class="line">    CFDataRef data = CGDataProviderCopyData(dataProvider);</div><div class="line"></div><div class="line">    UInt8 *buffer = (UInt8*)CFDataGetBytePtr(data);</div><div class="line"></div><div class="line">    NSUInteger  x, y;</div><div class="line">    for (y = 0; y &lt; height; y++) &#123;</div><div class="line">        for (x = 0; x &lt; width; x++) &#123;</div><div class="line">            UInt8 *tmp;</div><div class="line">            tmp = buffer + y * bytesPerRow + x * 4;</div><div class="line"></div><div class="line">            UInt8 red,green,blue;</div><div class="line">            red = *(tmp + 0);</div><div class="line">            green = *(tmp + 1);</div><div class="line">            blue = *(tmp + 2);</div><div class="line"></div><div class="line">            UInt8 brightness;</div><div class="line">            brightness = (77 * red + 28 * green + 151 * blue) / 256;</div><div class="line">            *(tmp + 0) = brightness;</div><div class="line">            *(tmp + 1) = brightness;</div><div class="line">            *(tmp + 2) = brightness;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    CFDataRef effectedData = CFDataCreate(NULL, buffer, CFDataGetLength(data));</div><div class="line"></div><div class="line">    CGDataProviderRef effectedDataProvider = CGDataProviderCreateWithCFData(effectedData);</div><div class="line"></div><div class="line">    CGImageRef effectedCgImage = CGImageCreate(</div><div class="line">                                               width, height,</div><div class="line">                                               bitsPerComponent, bitsPerPixel, bytesPerRow,</div><div class="line">                                               colorSpace, bitmapInfo, effectedDataProvider,</div><div class="line">                                               NULL, shouldInterpolate, intent);</div><div class="line"></div><div class="line">    UIImage *effectedImage = [[UIImage alloc] initWithCGImage:effectedCgImage];</div><div class="line"></div><div class="line">    CGImageRelease(effectedCgImage);</div><div class="line"></div><div class="line">    CFRelease(effectedDataProvider);</div><div class="line"></div><div class="line">    CFRelease(effectedData);</div><div class="line"></div><div class="line">    CFRelease(data);</div><div class="line"></div><div class="line">    return effectedImage;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>缓存图片到本地</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">注意：需要指定缓存路径，获取到本地沙盒路径等。</div><div class="line">+ (void)saveImageimageData:(NSData *)imgData</div><div class="line">&#123;</div><div class="line">    NSString *path = @&quot;chat/Image_send/&quot;;</div><div class="line">    if (![[NSFileManager defaultManager]fileExistsAtPath:[[LX_Sandbox docPath] stringByAppendingPathComponent:path]])</div><div class="line">        [[NSFileManager defaultManager]createDirectoryAtPath:[[LX_Sandbox docPath]stringByAppendingPathComponent:path] withIntermediateDirectories:YES attributes:nil error:nil];</div><div class="line"></div><div class="line">    NSString *imgPath = [[[LX_Sandbox docPath]stringByAppendingPathComponent:path]stringByAppendingPathComponent:[NSString stringWithFormat:@&quot;%@.png&quot;,[Function getSendMessageTime]]];</div><div class="line">    if ([[NSFileManager defaultManager]fileExistsAtPath:imgPath]) &#123;</div><div class="line">        [[NSFileManager defaultManager]removeItemAtPath:imgPath error:nil];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if ([[NSFileManager defaultManager]createFileAtPath:imgPath contents:nil attributes:nil]) &#123;</div><div class="line">        [imgData writeToFile:imgPath  atomically:YES];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>图片裁剪（传入Rect）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+(UIImage *)imageCropping:(UIImage*)image  rect:(CGRect)rect&#123;</div><div class="line"></div><div class="line">    CGImageRef cr = CGImageCreateWithImageInRect([image CGImage], rect);</div><div class="line">	UIImage *cropped = [UIImage imageWithCGImage:cr];</div><div class="line">	CGImageRelease(cr);</div><div class="line">    return cropped;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>按尺寸压缩图片</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">+ (UIImage*)scaleFromImage:(UIImage*)image scaledToSize:(CGSize)newSize</div><div class="line">&#123;</div><div class="line">    UIImage* newImage = nil;</div><div class="line">    @autoreleasepool &#123;</div><div class="line">        CGSize  imageSize = image.size;</div><div class="line">        CGFloat width = imageSize.width;</div><div class="line">        CGFloat height = imageSize.height;</div><div class="line"></div><div class="line">        if(width &lt;= newSize.width &amp;&amp; height &lt;= newSize.height)&#123;</div><div class="line">            return image;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if(width == 0 || height == 0)&#123;</div><div class="line">            return image;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        CGFloat widthFactor = newSize.width / width;</div><div class="line">        CGFloat heightFactor = newSize.height / height;</div><div class="line">        CGFloat scaleFactor = (widthFactor&lt;heightFactor?widthFactor:heightFactor);</div><div class="line"></div><div class="line">        CGFloat scaledWidth = width * scaleFactor;</div><div class="line">        CGFloat scaledHeight = height * scaleFactor;</div><div class="line">        CGSize  targetSize = CGSizeMake(scaledWidth,scaledHeight);</div><div class="line"></div><div class="line">        UIGraphicsBeginImageContext(targetSize);</div><div class="line">        [image drawInRect:CGRectMake(0,0,targetSize.width,targetSize.height)];</div><div class="line">        newImage = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">        UIGraphicsEndImageContext();</div><div class="line">    &#125;</div><div class="line">    return newImage;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>UIImage两种加载方式比较<br>在iOS中根据图片名或路径加载image方式就两种，<code>imageNamed</code>和<code>imageWithContentsOfFile</code>，今天主要说下这两者区别。</li>
</ul>
<blockquote>
<p>imageNamed加载图片会在内存中开辟空间对数据进行缓存，但是当APP内存警告时，不会主动对销毁这部分内存，所以针对多处使用同一个图片来说性能占优。<br>imageWithContentsOfFile则是根据图片路径（全路径）去加载，不会建立缓存，在APP内存警告时会自动销毁这部分内存，所以内存占用占优。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//imageWithContentsOfFile使用方法</div><div class="line">+ (UIImage *)getImageWithSourceOfPath:(NSString *)imageName&#123;</div><div class="line">    if (imageName.length == 0 || imageName == nil) &#123;</div><div class="line">        return [[UIImage alloc]init];</div><div class="line">    &#125;</div><div class="line">    UIImage *image = [UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:imageName ofType:@&quot;png&quot;]];</div><div class="line">    return image;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/05/swift实现手势解锁绘制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/05/swift实现手势解锁绘制/" itemprop="url">iOS实现手势解锁绘制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-05T17:52:30+08:00">
                2017-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>近期增加了object-c的具体应用，包括手势绘制，验证，更新，以及处理了一些手势绘制过程中Bug。详情见object-c实现。</p>
</blockquote>
<ul>
<li>一、swift实现</li>
</ul>
<p>使用swift实现iOS手势锁屏，虽然在iOS客户端很少使用到滑动手势，但是有时候为了和安卓应用保持用户交互的一致性，所以有的时候还是很有必要的。<br>iOS客户端解锁建议使用touch ID。</p>
<p>swift与object-c的CGContextRef不一样，在swift中统一使用CGContext进行管理和使用。</p>
<p>本示例采用9*button进行绘制，关闭button交互事件，通过touchesBegan系列方法对滑动路径进行跟踪和绘制（imageView）。</p>
<p>以下为全部代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div></pre></td><td class="code"><pre><div class="line">import UIKit</div><div class="line"></div><div class="line">  class TouchPasswordViewController: UIViewController &#123;</div><div class="line"></div><div class="line">    let screenWidth : CGFloat = UIScreen.main.bounds.size.width;</div><div class="line">    let screenHeight : CGFloat = UIScreen.main.bounds.size.height;</div><div class="line"></div><div class="line">    var btnArray : NSMutableArray = NSMutableArray.init(); //btn数组</div><div class="line">    var selectToArray : NSMutableArray = NSMutableArray.init();//选中的btn数组</div><div class="line">    var startPoint : CGPoint = CGPoint.init();//起点</div><div class="line">    var endPoint : CGPoint = CGPoint.init();//终点</div><div class="line">    var imageView : UIImageView = UIImageView.init();//绘制的背景</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    override func viewDidLoad() &#123;</div><div class="line">        super.viewDidLoad()</div><div class="line">        self.view.backgroundColor = UIColor.white;</div><div class="line"></div><div class="line">        imageView = UIImageView.init(frame: CGRect.init(x: 0, y: 0, width: screenWidth, height: screenHeight));</div><div class="line">        self.view.addSubview(imageView);</div><div class="line"></div><div class="line">        for i in 0...2 &#123;</div><div class="line">            for j in 0...2 &#123;</div><div class="line">                let btn : UIButton = UIButton.init(type: UIButtonType.custom);</div><div class="line">                btn.frame = CGRect.init(x: screenWidth / 12 + screenWidth / 3 * CGFloat(j), y: screenHeight / 3 + screenWidth / 3 * CGFloat(i), width: screenWidth / 6, height: screenWidth / 6);</div><div class="line"></div><div class="line">                btn.setImage(UIImage.init(named: &quot;尼罗河-4&quot;), for: UIControlState.normal);</div><div class="line">                btn.setImage(UIImage.init(named: &quot;尼罗河&quot;), for: UIControlState.selected);</div><div class="line">                btn.isUserInteractionEnabled = false;//取消button的交互事件，否则touch会被截断。</div><div class="line">                btnArray.add(btn);</div><div class="line">                imageView.addSubview(btn);</div><div class="line"></div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    func drawLine() -&gt; (UIImage)&#123;</div><div class="line">        var img : UIImage = UIImage.init();</div><div class="line">        let color : UIColor = UIColor.init(red: 1, green: 0, blue: 0, alpha: 1);</div><div class="line"></div><div class="line">        //绘制线条路径</div><div class="line">        UIGraphicsBeginImageContext(imageView.frame.size);</div><div class="line">        let context = UIGraphicsGetCurrentContext();</div><div class="line">        context?.setLineWidth(5);</div><div class="line">        context?.setStrokeColor(color.cgColor);</div><div class="line">        context?.move(to: startPoint);</div><div class="line"></div><div class="line">        for b in selectToArray &#123;</div><div class="line">            let btn : UIButton = b as! UIButton;</div><div class="line">            let btnPit = btn.center;</div><div class="line"></div><div class="line">            context?.addLine(to: btnPit);</div><div class="line">            context?.move(to: btnPit);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        context?.addLine(to: endPoint);</div><div class="line">        context?.strokePath();</div><div class="line"></div><div class="line">        img = UIGraphicsGetImageFromCurrentImageContext()!;</div><div class="line">        UIGraphicsEndImageContext();</div><div class="line"></div><div class="line">        return img;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    override func touchesBegan(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?) &#123;</div><div class="line">        let touch : UITouch = touches.first!;</div><div class="line">        for b in btnArray &#123;</div><div class="line">            let btn : UIButton = b as! UIButton;</div><div class="line">            let btnPit : CGPoint = touch.location(in: btn);</div><div class="line">            if btn.point(inside: btnPit, with: nil) &#123;//判断当前touch是否btn范围内，在则存入selectArray 并改变button状态</div><div class="line">                selectToArray.add(btn);</div><div class="line">                btn.isHighlighted = true;</div><div class="line">                startPoint = btn.center;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    override func touchesMoved(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?) &#123;</div><div class="line">        let touch : UITouch = touches.first!;</div><div class="line">        endPoint = touch.location(in: imageView);</div><div class="line"></div><div class="line">        for b in btnArray &#123;</div><div class="line">            let btn : UIButton = b as! UIButton;</div><div class="line">            let po : CGPoint = touch.location(in: btn);</div><div class="line"></div><div class="line">            if btn.point(inside: po, with: nil) &#123;</div><div class="line">                var isAdd : Bool = true;</div><div class="line"></div><div class="line">                for b in selectToArray &#123;</div><div class="line">                    let selectBtn : UIButton = b as! UIButton;</div><div class="line">                    if selectBtn == btn &#123;</div><div class="line">                        isAdd = false;</div><div class="line">                        break;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                if isAdd &#123;</div><div class="line">                    selectToArray.add(btn);</div><div class="line">                    btn.isHighlighted = true;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        imageView.image = self.drawLine();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    override func touchesEnded(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?) &#123;</div><div class="line">        imageView.image = nil;</div><div class="line">        selectToArray.removeAllObjects();</div><div class="line"></div><div class="line">        for b in btnArray &#123;</div><div class="line">            let btn : UIButton = b as! UIButton;</div><div class="line">            btn.isHighlighted = false;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    override func didReceiveMemoryWarning() &#123;</div><div class="line">        super.didReceiveMemoryWarning()</div><div class="line">        // Dispose of any resources that can be recreated.</div><div class="line">    &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>二、object-c实现<blockquote>
<p>object-c实现与swift逻辑一致，只是加入在实际使用过程中遇到的问题，使其更有参考性和实际应用价值。<br>注：代码中有部分资源是中英文适配使用的。如：NSLocalizedString</p>
</blockquote>
</li>
</ul>
<p>在object-c中考虑到屏幕适配会导致button图片拉伸，所以使用UIView代替UIButton。自定义了一个UIView.<br>1、RoundRectView.h</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#import &lt;UIKit/UIKit.h&gt;</div><div class="line"></div><div class="line">@interface RoundRectView : UIView</div><div class="line">@property (nonatomic, strong) UIView *selectView;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>2、RoundRectView.m</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">#import &quot;RoundRectView.h&quot;</div><div class="line">#import &quot;SysConfig.h&quot;</div><div class="line"></div><div class="line">@interface RoundRectView ()</div><div class="line">&#123;</div><div class="line">    CGFloat _width;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation RoundRectView</div><div class="line"></div><div class="line">- (instancetype)initWithFrame:(CGRect)frame</div><div class="line">&#123;</div><div class="line">    self = [super initWithFrame:frame];</div><div class="line">    if (self) &#123;</div><div class="line">        _width = frame.size.width / 4.0;</div><div class="line">        [self initUI];</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)initUI&#123;</div><div class="line">    self.backgroundColor = [UIColor whiteColor];</div><div class="line">    self.layer.masksToBounds = YES;</div><div class="line">    self.layer.cornerRadius = self.frame.size.width/ 2.0;</div><div class="line">    self.layer.borderWidth = 2.0;</div><div class="line">    self.layer.borderColor = [UIColor hexString:@&quot;#3fb8c8&quot;].CGColor;</div><div class="line"></div><div class="line">    self.selectView = [[UIView alloc] initWithFrame:CGRectMake((self.frame.size.width - _width) / 2, (self.frame.size.width - _width) / 2, _width, _width)];</div><div class="line">    self.selectView.backgroundColor = [UIColor hexString:@&quot;#3fb8c8&quot;];</div><div class="line">    self.selectView.layer.masksToBounds = YES;</div><div class="line">    self.selectView.layer.cornerRadius = _width / 2.0;</div><div class="line">    self.selectView.hidden = YES;</div><div class="line">    [self addSubview:self.selectView];  </div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>3、TouchUpViewController.h</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">#import &lt;UIKit/UIKit.h&gt;</div><div class="line">#import &quot;LXBaseViewController.h&quot;</div><div class="line"></div><div class="line">typedef enum : NSUInteger &#123;</div><div class="line">    TouchUnlockCreatePwd,//绘制</div><div class="line">    TouchUnlockValidatePwd,//验证</div><div class="line">    TouchUnlockUpdatePwd,//修改手势</div><div class="line">&#125; UnlockType;</div><div class="line"></div><div class="line">@interface TouchUpViewController : LXBaseViewController</div><div class="line"></div><div class="line">- (instancetype)initWithUnlockType:(UnlockType)type;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>4、TouchUpViewController.m</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div></pre></td><td class="code"><pre><div class="line">#import &quot;TouchUpViewController.h&quot;</div><div class="line">#import &quot;RoundRectView.h&quot;</div><div class="line">#import &quot;SysConfig.h&quot;</div><div class="line">#import &quot;AppDelegate.h&quot;</div><div class="line">#import &quot;LXNetworkRequest.h&quot;</div><div class="line">#import &quot;LXNetworkRequest+LogWithEmail.h&quot;</div><div class="line"></div><div class="line">#define APPDELEGATEREAL (AppDelegate *)[UIApplication sharedApplication].delegate</div><div class="line">#define TouchUnlockPwdKey  @&quot;touchUnlockPwdKey&quot;</div><div class="line"></div><div class="line">@interface TouchUpViewController ()</div><div class="line">&#123;</div><div class="line">    NSMutableArray *_nomarlArray,*_selectArray;</div><div class="line">    CGFloat _width,_height;</div><div class="line">    UIImageView *_imageView;</div><div class="line">    CGPoint _startPoint,_endPoint;</div><div class="line">    NSMutableString *_password;</div><div class="line">    NSString *_oldPassword;</div><div class="line">    UnlockType _unlockType;</div><div class="line">    NSInteger _errorCount;</div><div class="line"></div><div class="line">    UIImageView *_headerImageView;</div><div class="line">    UILabel *_nickNameLabel,*_tipLabel;</div><div class="line">    UIButton *_loginBtn;</div><div class="line"></div><div class="line">    BOOL isUpdatePwd;</div><div class="line"></div><div class="line">    NSInteger _steps;//1 验证密码 2：创建第一遍   3：创建第二遍</div><div class="line">&#125;</div><div class="line">@end</div><div class="line"></div><div class="line">@implementation TouchUpViewController</div><div class="line"></div><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line">    self.title = NSLocalizedString(@&quot;Draw Pattern&quot;, nil);</div><div class="line">    self.view.backgroundColor = [UIColor whiteColor];</div><div class="line">    [self initUI];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)comeBack:(id)sender</div><div class="line">&#123;</div><div class="line">    [self.navigationController popViewControllerAnimated:YES];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (instancetype)initWithUnlockType:(UnlockType)type&#123;</div><div class="line"></div><div class="line">    self = [super init];</div><div class="line">    if (self) &#123;</div><div class="line">        _unlockType = type;</div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)initUI&#123;</div><div class="line"></div><div class="line">    NSUserDefaults *def = [NSUserDefaults standardUserDefaults];</div><div class="line">    NSString *savePwd = [def objectForKey:TouchUnlockPwdKey];</div><div class="line"></div><div class="line">    _width = [UIScreen mainScreen].bounds.size.width;</div><div class="line">    _height = [UIScreen mainScreen].bounds.size.height;</div><div class="line"></div><div class="line">    _password = [NSMutableString string];</div><div class="line">    _nomarlArray = [NSMutableArray array];</div><div class="line">    _selectArray = [NSMutableArray array];</div><div class="line"></div><div class="line">    _imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, _width, _height)];</div><div class="line">    [self.view addSubview:_imageView];</div><div class="line"></div><div class="line"></div><div class="line">    CGFloat leftSpace = fitScreenWidth(40);</div><div class="line">    CGFloat wd = (_width - leftSpace * 2) /8.0;</div><div class="line"></div><div class="line">    NSInteger index = 1;</div><div class="line">    for (int i = 0; i &lt; 3; i ++) &#123;</div><div class="line">        for (int j = 0; j &lt; 3; j ++) &#123;</div><div class="line"></div><div class="line">            CGRect rect = CGRectMake(leftSpace + wd * 3 * j, _height / 3.0 + wd * 3 * i, wd * 2, wd * 2);</div><div class="line">            RoundRectView *ve = [[RoundRectView alloc] initWithFrame:rect];</div><div class="line"></div><div class="line">            ve.tag = index ++;</div><div class="line"></div><div class="line">            [_nomarlArray addObject:ve];</div><div class="line">            [_imageView addSubview:ve];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    //    -   -  -  - -  header - - - - - - -  - -</div><div class="line">    _headerImageView = [[UIImageView alloc] initWithFrame:CGRectMake((_width - fitScreenWidth(50)) / 2, fitScreenWidth(60), fitScreenWidth(50), fitScreenWidth(50))];</div><div class="line">    _headerImageView.backgroundColor = [UIColor whiteColor];</div><div class="line">    [self.view addSubview:_headerImageView];</div><div class="line"></div><div class="line">    _nickNameLabel = [[UILabel alloc] initWithFrame:CGRectMake((_width - fitScreenWidth(100)) / 2, CGRectGetMaxY(_headerImageView.frame), fitScreenWidth(100), fitScreenWidth(25))];</div><div class="line">    _nickNameLabel.font = [UIFont systemFontOfSize:fitScreenWidth(12.0)];</div><div class="line">    _nickNameLabel.hidden = YES;</div><div class="line">    _nickNameLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    [self.view addSubview:_nickNameLabel];</div><div class="line"></div><div class="line">    _tipLabel = [[UILabel alloc] initWithFrame:CGRectMake(20, CGRectGetMaxY(_nickNameLabel.frame), _width - 20 * 2, fitScreenWidth(25))];</div><div class="line">    _tipLabel.font = [UIFont systemFontOfSize:fitScreenWidth(13.0)];</div><div class="line">    _tipLabel.textAlignment = NSTextAlignmentCenter;</div><div class="line">    _tipLabel.textColor = [UIColor lightGrayColor];</div><div class="line">    [self.view addSubview:_tipLabel];</div><div class="line"></div><div class="line"></div><div class="line">    _loginBtn = [[UIButton alloc] initWithFrame:CGRectMake((_width - fitScreenWidth(150)) / 2 , _height - fitScreenWidth(55), fitScreenWidth(150), 30)];</div><div class="line">    _loginBtn.titleLabel.font = [UIFont systemFontOfSize:fitScreenWidth(13.0)];</div><div class="line"></div><div class="line">    [_loginBtn setTitle:NSLocalizedString(@&quot;Use login password&quot;, nil) forState:UIControlStateNormal];</div><div class="line">    [_loginBtn setTitleColor:[UIColor hexString:@&quot;#3fb8c8&quot;] forState:UIControlStateNormal];</div><div class="line">    [_loginBtn setHidden:YES];</div><div class="line">    [_loginBtn addTarget:self action:@selector(loginWithPwd) forControlEvents:UIControlEventTouchUpInside];</div><div class="line">    [self.view addSubview:_loginBtn];</div><div class="line"></div><div class="line"></div><div class="line">    UIBarButtonItem *resetBtn = [[UIBarButtonItem alloc] initWithTitle:NSLocalizedString(@&quot;Reset&quot;, nil) style:UIBarButtonItemStylePlain target:self action:@selector(resetBtnClick)];</div><div class="line">    self.navigationItem.rightBarButtonItem = resetBtn;</div><div class="line"></div><div class="line">    if (_unlockType == TouchUnlockCreatePwd) &#123;</div><div class="line">        //绘制</div><div class="line">        _steps = 2;</div><div class="line">        _tipLabel.text = NSLocalizedString(@&quot;Draw Your Pattern&quot;, nil);</div><div class="line">    &#125;</div><div class="line">    else if (_unlockType == TouchUnlockUpdatePwd)&#123;</div><div class="line">        //更新密码不验证原密码 直接新增 !savePwd || savePwd.length == 0</div><div class="line">        _unlockType = TouchUnlockCreatePwd;</div><div class="line">        _tipLabel.text = NSLocalizedString(@&quot;Draw new pattern&quot;, nil);</div><div class="line">        _steps = 2;</div><div class="line">    &#125;</div><div class="line">    else if (_unlockType == TouchUnlockValidatePwd)&#123;</div><div class="line">        //验证密码</div><div class="line">        _steps = 1;</div><div class="line">        _errorCount = 5;</div><div class="line">        [_loginBtn setHidden:NO];</div><div class="line">        _tipLabel.text = NSLocalizedString(@&quot;Draw Your Pattern&quot;, nil);</div><div class="line">        _headerImageView.layer.masksToBounds = YES;</div><div class="line">        _headerImageView.layer.cornerRadius = fitScreenWidth(50) / 2;</div><div class="line">        [_headerImageView setNewImageUrl:APPDELEGATE.userModel.avatar placeHolder:[UIImage imageNamed:@&quot;login_content_Avatar@2x&quot;]];</div><div class="line"></div><div class="line">        _nickNameLabel.hidden = NO;</div><div class="line">        _nickNameLabel.text = APPDELEGATE.userModel.nickname;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if ([savePwd isEqualToString:@&quot;TouchPwdError&quot;]) &#123;</div><div class="line">        //密码失效，直接弹出提示框</div><div class="line">        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">            [self alertPwdError];</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)changeUI:(UnlockType)type&#123;</div><div class="line">    //切换头部视图</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)changeTip:(NSInteger)index&#123;</div><div class="line">    //改变警告文字  1:最少四个点，请重新绘制  2:与上次绘制不一致，请重新绘制 3：密码错误还可以输入5次</div><div class="line">    _tipLabel.textColor = [UIColor redColor];</div><div class="line">    NSString *text = nil;</div><div class="line">    switch (index) &#123;</div><div class="line">        case 1:</div><div class="line">        &#123;</div><div class="line">            text = NSLocalizedString(@&quot;At least 4 points required&quot;, nil);</div><div class="line">        &#125;</div><div class="line">            break;</div><div class="line"></div><div class="line">        case 2:</div><div class="line">        &#123;</div><div class="line">            text = NSLocalizedString(@&quot;Not match. Please draw it again&quot;, nil);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">            break;</div><div class="line"></div><div class="line">        case 3:</div><div class="line">        &#123;</div><div class="line">            text = _errorCount == 10000 ? [NSString stringWithFormat:NSLocalizedString(@&quot;Invalid password. Please draw it again&quot;, nil)] : [NSLocalizedString(@&quot;Invalid password.*** attempt(s) left&quot;, nil) stringByReplacingOccurrencesOfString:@&quot;***&quot; withString:[NSString stringWithFormat:@&quot;%ld&quot;,_errorCount -- &gt; 0 ? _errorCount : 0]];</div><div class="line">        &#125;</div><div class="line">            break;</div><div class="line"></div><div class="line"></div><div class="line">        default:</div><div class="line">            break;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    _tipLabel.text = text;</div><div class="line"></div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line"></div><div class="line">        if (_unlockType == TouchUnlockCreatePwd) &#123;</div><div class="line">            if (_steps == 2) &#123;</div><div class="line">                [self changeTipForNormal:1];</div><div class="line">            &#125;</div><div class="line">            else if (_steps == 3)&#123;</div><div class="line">                [self changeTipForNormal:3];</div><div class="line">            &#125;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        [self changeTipForNormal:1];</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)changeTipForNormal:(NSInteger)index&#123;</div><div class="line">    _tipLabel.textColor = [UIColor lightGrayColor];</div><div class="line">    NSString *text = @&quot;&quot;;</div><div class="line">    switch (index) &#123;</div><div class="line">        case 1:</div><div class="line">            text = NSLocalizedString(@&quot;Draw Your Pattern&quot;, nil);</div><div class="line">            break;</div><div class="line">        case 2:</div><div class="line">            text = @&quot;请输入原手势密码&quot;;</div><div class="line">            break;</div><div class="line">        case 3:</div><div class="line">            text = NSLocalizedString(@&quot;Draw pattern again&quot;, nil);</div><div class="line">            break;</div><div class="line">        case 4:</div><div class="line">            text = NSLocalizedString(@&quot;Draw Your Pattern&quot;, nil);</div><div class="line">            break;</div><div class="line"></div><div class="line">        default:</div><div class="line">            break;</div><div class="line">    &#125;</div><div class="line">    _tipLabel.text = text;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (UIImage *)drawline&#123;</div><div class="line"></div><div class="line">    if (_selectArray.count == 0) &#123;</div><div class="line">        return nil;</div><div class="line">    &#125;</div><div class="line">    RoundRectView *ve = _selectArray.firstObject;</div><div class="line">    CGPoint vePoint = ve.center;</div><div class="line">    _startPoint = vePoint;</div><div class="line"></div><div class="line">    UIImage *img = [[UIImage alloc] init];</div><div class="line">    UIColor *color = [UIColor hexString:@&quot;#3fb8c8&quot;];</div><div class="line"></div><div class="line">    UIGraphicsBeginImageContext(_imageView.frame.size);</div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">//    CGContextSetAllowsAntialiasing(context,true);</div><div class="line">//    CGContextSetShouldAntialias(context, true);</div><div class="line"></div><div class="line">    CGContextSetLineWidth(context, 2);</div><div class="line">    CGContextSetStrokeColorWithColor(context, color.CGColor);</div><div class="line">    CGContextMoveToPoint(context, _startPoint.x, _startPoint.y);</div><div class="line"></div><div class="line"></div><div class="line">    if (_selectArray.count == 0) &#123;</div><div class="line">        return nil;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    for (RoundRectView *ve in _selectArray) &#123;</div><div class="line">        CGPoint po = ve.center;</div><div class="line">        CGContextAddLineToPoint(context, po.x, po.y);</div><div class="line">        CGContextMoveToPoint(context, po.x, po.y);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    CGContextAddLineToPoint(context, _endPoint.x, _endPoint.y);</div><div class="line">    CGContextStrokePath(context);</div><div class="line"></div><div class="line">    img = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line"></div><div class="line">    return img;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123;</div><div class="line"></div><div class="line">    UITouch *touch = [touches anyObject];</div><div class="line">    if (touch) &#123;</div><div class="line">        for (RoundRectView *ve in _nomarlArray) &#123;</div><div class="line">            CGPoint point = [touch locationInView:ve];</div><div class="line"></div><div class="line">            if ([ve pointInside:point withEvent:nil]) &#123;</div><div class="line">                [_selectArray addObject:ve];</div><div class="line">                [self savePassWord:ve.tag];</div><div class="line">                ve.selectView.hidden = NO;</div><div class="line">                _startPoint = ve.center;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)touchesMoved:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123;</div><div class="line">    UITouch *touch = [touches anyObject];</div><div class="line">    if (touch) &#123;</div><div class="line">        _endPoint = [touch locationInView:_imageView];</div><div class="line"></div><div class="line">        for (RoundRectView *ve in _nomarlArray) &#123;</div><div class="line">            CGPoint point = [touch locationInView:ve];</div><div class="line"></div><div class="line">            if ([ve pointInside:point withEvent:nil]) &#123;</div><div class="line"></div><div class="line">                BOOL isAdd = YES;</div><div class="line">                for (RoundRectView *vv in _selectArray) &#123;</div><div class="line">                    if (vv == ve) &#123;</div><div class="line">                        isAdd = NO;</div><div class="line">                        break;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                if (isAdd) &#123;</div><div class="line">                    [_selectArray addObject:ve];</div><div class="line">                    [self savePassWord:ve.tag];</div><div class="line">                    ve.selectView.hidden = NO;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    _imageView.image = [self drawline];</div><div class="line">    _imageView.layer.contentsScale = [[UIScreen mainScreen] scale];</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)touchesEnded:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123;</div><div class="line"></div><div class="line">    UITouch *touch = [touches anyObject];</div><div class="line">    if (touch) &#123;</div><div class="line">        for (RoundRectView *ve in _nomarlArray) &#123;</div><div class="line">            CGPoint po = [touch locationInView:ve];</div><div class="line">            if (![ve pointInside:po withEvent:nil]) &#123;</div><div class="line">                RoundRectView *seVe = _selectArray.lastObject;</div><div class="line">                _endPoint = seVe.center;</div><div class="line">                _imageView.image = [self drawline];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    [self cheakPassword];</div><div class="line"></div><div class="line">    _password = [NSMutableString string];</div><div class="line"></div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line"></div><div class="line">        _imageView.image = nil;</div><div class="line">        [_selectArray removeAllObjects];</div><div class="line"></div><div class="line">        for (RoundRectView *ve in _nomarlArray) &#123;</div><div class="line">            ve.selectView.hidden = YES;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)didReceiveMemoryWarning &#123;</div><div class="line">    [super didReceiveMemoryWarning];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)savePassWord:(NSInteger)tag&#123;</div><div class="line">    [_password appendFormat:@&quot;%ld&quot;,tag];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)cheakPassword&#123;</div><div class="line"></div><div class="line">    if (_password.length &lt; 4) &#123;</div><div class="line">        [self changeTip:1];</div><div class="line">        return; //密码长度不够</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (_unlockType == TouchUnlockCreatePwd) &#123;</div><div class="line"></div><div class="line">        if (_steps == 2) &#123;</div><div class="line">            _oldPassword = _password;</div><div class="line">            [self changeTipForNormal:3];</div><div class="line">            _steps = 3;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (_steps == 3) &#123;</div><div class="line">            if (![_password isEqualToString:_oldPassword]) &#123;</div><div class="line">                [self changeTip:2];</div><div class="line">                return; //前后不一致</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if ([_oldPassword isEqualToString:_password]) &#123;</div><div class="line">                //两次密码一致 存本地</div><div class="line">                NSUserDefaults *def = [NSUserDefaults standardUserDefaults];</div><div class="line">                [def setObject:_password forKey:TouchUnlockPwdKey];</div><div class="line">                [MessageCenter openAlertViewWithMessage:NSLocalizedString(@&quot;Success&quot;, nil) duringtime:1];</div><div class="line">                [self.navigationController popViewControllerAnimated:YES];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    else if (_unlockType == TouchUnlockValidatePwd || _unlockType == TouchUnlockUpdatePwd)&#123;</div><div class="line">        //获取保存的密码</div><div class="line">        NSUserDefaults *def = [NSUserDefaults standardUserDefaults];</div><div class="line">        NSString *savePwd = [def objectForKey:TouchUnlockPwdKey];</div><div class="line"></div><div class="line">        if (![savePwd isEqualToString:_password] &amp;&amp; _steps == 1) &#123;</div><div class="line">            //原密码错误</div><div class="line">            _steps = 1;</div><div class="line">            [self changeTip:3];</div><div class="line"></div><div class="line">            if (_errorCount &lt;= 0) &#123;</div><div class="line">                //错误次数太多</div><div class="line">                [self alertPwdError];</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        //登陆成功</div><div class="line">        if (_unlockType == TouchUnlockValidatePwd) &#123;</div><div class="line"></div><div class="line">            _errorCount = 5;</div><div class="line">//            [self dismissViewControllerAnimated:YES completion:nil];</div><div class="line"></div><div class="line">            if (![APPDELEGATEREAL lockScreenWindow].hidden) &#123;</div><div class="line">                [APPDELEGATEREAL lockScreenWindow].hidden = YES;</div><div class="line">            &#125;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (_steps == 1) &#123;</div><div class="line">            [self changeTipForNormal:1];</div><div class="line">            _steps = 2;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (_steps == 2) &#123;</div><div class="line">            _oldPassword = _password;</div><div class="line">            [self changeTipForNormal:3];</div><div class="line">            _steps = 3;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (_steps == 3) &#123;</div><div class="line">            if (![_password isEqualToString:_oldPassword]) &#123;</div><div class="line">                 [self changeTip:2];</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if ([_oldPassword isEqualToString:_password]) &#123;</div><div class="line">                //两次密码一致 存本地</div><div class="line">                NSUserDefaults *def = [NSUserDefaults standardUserDefaults];</div><div class="line">                [def setObject:_password forKey:TouchUnlockPwdKey];</div><div class="line"></div><div class="line">                NSLog(@&quot;密码更新成功:%@&quot;,_password);</div><div class="line">                [MessageCenter openAlertViewWithMessage:NSLocalizedString(@&quot;Success&quot;, nil) duringtime:1];</div><div class="line">                dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</div><div class="line">                    [self.navigationController popViewControllerAnimated:YES];</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)alertPwdError&#123;</div><div class="line">    //手势密码失效</div><div class="line">    [[NSUserDefaults standardUserDefaults] setObject:@&quot;TouchPwdError&quot; forKey:TouchUnlockPwdKey];</div><div class="line"></div><div class="line">    UIAlertController *alert = [UIAlertController alertControllerWithTitle:NSLocalizedString(@&quot;Pattern is expired&quot;, nil) message:NSLocalizedString(@&quot;Please login with password&quot;, nil) preferredStyle:UIAlertControllerStyleAlert];</div><div class="line"></div><div class="line">    NSMutableAttributedString *alertControllerMessageStr = [[NSMutableAttributedString alloc] initWithString:NSLocalizedString(@&quot;Please login with password&quot;, nil)];</div><div class="line">    [alertControllerMessageStr addAttribute:NSForegroundColorAttributeName value:[UIColor hexString:@&quot;#999999&quot;] range:NSMakeRange(0, alertControllerMessageStr.length)];</div><div class="line">    [alertControllerMessageStr addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:12] range:NSMakeRange(0, alertControllerMessageStr.length)];</div><div class="line">    [alert setValue:alertControllerMessageStr forKey:@&quot;attributedMessage&quot;];</div><div class="line"></div><div class="line">    UIAlertAction *toAction = [UIAlertAction actionWithTitle:NSLocalizedString(@&quot;Login again&quot;, nil) style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123;</div><div class="line">        [self loginWithPwd];</div><div class="line">    &#125;];</div><div class="line">    [alert addAction:toAction];</div><div class="line">    [self presentViewController:alert animated:YES completion:nil];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)loginWithPwd&#123;</div><div class="line">    LX_LoginAndForgetViewController *loginVc = [[LX_LoginAndForgetViewController alloc] init];</div><div class="line">    loginVc.isTouchUnlockIn = YES;</div><div class="line">    [self presentViewController:loginVc animated:YES completion:nil];</div><div class="line">&#125;</div><div class="line"></div><div class="line">//重设</div><div class="line">- (void)resetBtnClick&#123;</div><div class="line">    _oldPassword = nil;</div><div class="line">    _steps = 2;</div><div class="line">    [self changeTipForNormal:1];</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p>5、AppDelegate中新增UIwindow属性用于遮罩</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//didFinishLaunchingWithOptions方法加入</div><div class="line">self.lockScreenWindow = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];</div><div class="line"> self.lockScreenWindow.windowLevel= UIWindowLevelAlert+1;//最高级等级窗口</div><div class="line"> self.lockScreenWindow.backgroundColor = [UIColor whiteColor];</div><div class="line"> TouchUpViewController *lockvc  =[[TouchUpViewController alloc]initWithUnlockType:TouchUnlockValidatePwd];</div><div class="line"> self.lockScreenWindow.rootViewController = lockvc;</div><div class="line"> self.lockScreenWindow.hidden = YES;</div></pre></td></tr></table></figure>
<p>在合适的时候对lockScreenWindow.hidden属性进行操作。</p>
<p>通过上述两个类，初步建立了手势密码的逻辑体系。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/05/我，“没有爱好”/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/05/我，“没有爱好”/" itemprop="url">我，“没有爱好”</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-05T10:33:42+08:00">
                2017-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/个人随笔/" itemprop="url" rel="index">
                    <span itemprop="name">个人随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>几年我25岁了，除了日常的生活工作学习，在闲暇时间我不清楚我自己该做点什么或者去哪看看。平常工作盼着假期，而到了假期却憧憬着工作。对，这就是我，一个25岁还没有找到能够让自己快乐或者觉得有意义的事情。</p>
<p>记得，曾经也喜欢到处游走，哪怕什么都不做，看看就是好的，心里也就满足。近年来，一到假期到处都是人山人海，我也懒得去人多的地方凑热闹。这样一来一去不出门仿佛就成为了习惯，假期里除了提前说好了的，都是在家混着时间过了。</p>
<p>我尝试过去培养一些自己的兴趣爱好，比如旅旅游，拍拍照，加入一些户外俱乐部做一些户外运动或者是参加一些论坛活动。相继我也购入了单反相机来充实自己。后来才发现有一些路不适合作为兴趣，比如单反相机，器材需要耗费大量的资金，而我撑不起我的爱好，所以我选择了闲置和放弃拍照。</p>
<p>我这个人，不抽烟，少喝酒，不打游戏，所以没有可以玩的兴趣。别的人还可以钓钓鱼，逛逛酒吧，喝喝咖啡，打打麻将，我就在家闲着，闲着有时间去思考，去思考未来。</p>
<p><img src="https://raw.githubusercontent.com/misszero8090/he8090_blog/master/img/2017-06-04%20145814.jpg" alt="2017-06-04 145814"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/02/《对于未来三十年，该思考的事情》有感/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/02/《对于未来三十年，该思考的事情》有感/" itemprop="url">《对于未来三十年，该思考的事情》有感</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T14:28:34+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/个人随笔/" itemprop="url" rel="index">
                    <span itemprop="name">个人随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>马云的这篇演讲说明了他对未来三十年发展的预测，随着生产力提升，科技进步，未来的人类应该是越来越懒，人类将不再专注工作和提升技术，重心应该转移到生活享受和规则制定上去。未来需要的是规则，而人类就是这个规则的制定者。</p>
<blockquote>
<p>对于未来三十年，该思考的事情。<br>以下是演讲全文：<br> 马云：谢谢理事长！我觉得做CEO主要是两件事，一是看未来的机会，二是看未来的灾难。绝大部分的老板如果看不到未来的机会是没办法激励你的员工，另外一个职责是看到未来有什么灾难和麻烦。如果你能知道社会一定会出这样的麻烦，并且你提前做好准备，就会很成功。所以我自己觉得，作为CEO有两个职责，全体员工以及所有的人都开始提心吊胆，都未来没有信心的时候，你必须看到希望所在。所有的人都在畅想未来的时候，你必须看到灾难所在，任何一个灾难和麻烦，都有可能是巨大的机会。<br>我自己不断讲一些自己的观点看法，在座有很多年轻人，我父亲是一个很普通的职工，但他对文艺的爱好一直努力，后来做了曲艺家协会主席，我妈更是普通的人。像我们这些年轻人没有有钱有势的父母，没有有关系的舅舅，我们没有昨天的积累，没有今天的资源，唯一要做的事是对未来的判断。而未来的判断至少是十年以后，你认为这个会有这样的问题或者机会，你坚持往这个方向走十年，也许你就会赢得机会。我们不能跟别人拼昨天，也许没办法跟别人拼今天，必须要对未来有一个判断。<br>我对未来30年整个世界的变化会超过大家的想象，未来30年社会矛盾的经历，各行各业都会受到巨大的冲击，对你来看，如果你感到悲哀，它永远是个麻烦，如果你觉得是个机会，它会你不可多得的机会。因为我是老师出身，从来没有想到自己会当CEO，今天我接触了世界上这么多优秀的人，我觉得我有这个责任把这些想法跟别人分享，不是我多愿意讲话，但是我觉得这是一个担当，这是一个责任，你必须要去思考。<br>其实很多人在骂我们，部分企业说我们把他们的超市、商场搞掉了，但是我自己觉得15年以前我在世界各地讲过两三百次这样的演讲，提醒大家互联网、电子商务对各行各业的冲击。今天既然已经有这样的资源，还是要告诉大家，未来二三十年这个世界的变化超过所有人的想象力，而且绝大部分人是很倒霉的。<br>我首先要讲到的是任何一次技术革命50年，前20年一定是技术公司的事情，后面30年一定是技术的应用，从过去的20年从互联网技术将会进入互联网时代，未来30年任何一个企业如果你不跟互联网有挂钩，如果不利用互联网去发展自己的业务，就会变得比100年以前或者几十年以前缺乏电一样可怕，甚至比断了电更可怕。我还认为，今天不是互联网冲击了你，是落后的思想似乎想保留昨天这种想法，不拥抱技术的思考冲击了你，全世界实体经济越来越难做，我认为实体经济从来没好做过，中国多少企业在努力，剩下了这么一点点企业家，他们付出的辛苦是超越常人的，全世界只有中国把实体经济和虚拟经济完全对立起来。我经常听网上有一句话叫实体报国，我总觉得这句话非常别扭，实体和虚拟不应该对立起来，这样的完美结合才是未来真正的经济，也只有中国把互联网经济称之为虚拟经济，虚拟经济在欧美主要定义为金融机构，在中国是没人敢批评金融机构的，因为批评金融机构你就贷不到款。实体经济的真正定义有两个重要的组成部分，一是生产制造，二是流通，生产制造过去的30年中国取得了重大进步，但是流通环节我们做得不行，正是因为这样，我们今天出了大量的问题，包括库存、积压和产能过剩，因为我们对市场根本不了解，还是按照想当然在这里做。特别是在美国，经济受到冲击以后反思一个问题，为什么没有抓住互联网这一拨，而我们这里似乎人人觉得批评互联网是很光荣的事情，这世界上没有人想故意害你，而且也不是实体经济都不好，也有实体经济好的，特斯拉不好吗？苹果不好吗？所有的企业今天已经到了这个时候，你还在怪一个技术的时候，那只是你倒霉。<br>我那次在深圳互联网IT领袖峰会上也讲，100多年前别人说我们是东亚病夫，那是身体上虚弱，但是到今天我们要思考知识结构文化让我们真正变成网络病夫，我们在埋怨、抱怨，不学习，这是很可怕的事情。所以我们要改变适应未来，如果不能创造未来，至少要做到适应未来。<br>我讲了很多遍，还是要想未来在中国十年到二十年以内，五个新一定会冲击各行各业。第一是零售出现新零售，我的观点是线上线下物流数据必须结合起来，打造新型的零售体系。互联网企业从来没有觉得打败超市是光荣的事情，超市也不要觉得打败互联网是多么值得骄傲的事情，未来零售行业要学习的不是怎么卖东西，而是怎么服务别人，学会服务是不管你是互联网电子商务，还是线下零售也好，最重要的事情。一切不是以企业为本，不是以成本为本，不是以资源为本，而是以人为本。所以零售行业启动了第一拨冲击刚刚过去，第二拨冲击是新制造。原来制造行业以标准化、规模化、低成本这些我们听得最多，所有的MBA都是这样讲，这一套东西很快会全部被个性化、定制化、智能化取代，以前我们希望买的东西越来越标准，今后一定是个性化。如何把个性化的东西标准化，把标准化的东西个性化，我也想告诉大家，出现大数据以后，未来巨大的变革对中国制造业的冲击远远超过零售行业。我现在提醒大家，在广东地区原来我们以流水线为作业的很多单位，这些冲击在十年到十五年以内会非常令人恐怖和担忧，一切机器设备会越来越机械化。手机本来是一个普通的电话，加入了操作系统和移动系芯片以后，打电话只占20%的功能，80%跟打电话没关系。手机成为了人身体中的一部分，手机是陪伴你时间最长的，因为世界会变得越来越移动，陪伴你超过了你的父母和老婆。未来的汽车如果加上操作系统，交通功能最多不会超过40%，将来只要通过电的东西都会智慧化，所以新制造的冲击很快就会来临。而且你如果不去做这个准备，我觉得麻烦的一定是你。<br>还有新金融，刚才洪董事长也讲到新金融。我理解的新金融最大的变革是由原来的二八变成八二，原来金融机构只要服务好20%的大客户就行了，服务好国有企业，服务好跨国企业，服务好有钱的企业，然后赚80%的利润，他们是服务20%的客户赚80%的利润，日子过得非常好。但是未来的世界一定是八二，也就是你必须要服务好80%昨天没有被金融机构服务的东西，未来的金融必须是普惠的，未来的金融必须是每个人有公平的套路。如果你今天不去思考80%没有被服务的，你不去思考金融是让每个人拥有公平的权力，你没办法做，如果你不去思考如何让金融变得普惠，你不会取得很好的发展。<br>曾经有人问我，马云，你觉得未来支付宝怎么挣钱以及未来的发展是什么？我说我没有想象怎么挣钱，就是一个要求，我希望支付宝能够让任何一个老太太的权力跟银行董事长的权力是一样的。刚好那一天我隔壁有一个老太太说晚上回家晚了，那天断了电，电费忘了交，老太太大清早起来到银行门口排队缴费。那些大行长、大银行家们叫秘书们去付了钱，我觉得如果手机上按一下，不管是什么长，按一下手机都可以付掉，这个叫新金融。当然也有人讲，微信支付和支付宝竞争得很厉害，我觉得多好，支付宝打了几十年，所有的政策跟银行争，结果人家顺水而上，我说很好，只要有人参与，能够把二八变成八二，这个社会进步，我们都有好处。<br>另外一个，什么是新技术？技术在未来的发展也远远超过之前三十年，PC芯片、路由器等等，这个行业发展非常迅猛，使得绝大多数欧美地区和中国的发达城市充分掌握了IT技术，使得企业越来越强大。但是未来由于互联网导致的数据技术，互联网将成为一个最重要的基础设施，数据将成为所有企业创新的能源。如果这是一个基础的话，未来在移动芯片、移动操作系统方面诞生的操作系统将层出不穷。所以各种各样的人工智能、云计算、大数据，这些东西大家不要把它当概念，我这里提醒大家，你听不懂没关系，但是不要去抵抗它，听不懂唯一的办法把你们公司的年轻人叫过来，如何支持你往前走，更何况这些技术不是要靠大量成本投入下去才能做到的，只要今天相信未来，这样去努力一定会有机会。<br>最后还有新能源，第一代能源是煤，第二代能源是石油，第三代能源是数据。第一次技术革命以煤为主的能源造成的商业模式是工厂，第二次以石油为主的商业模式技术革命诞生了公司，这一次将会以什么样的公司商业模式，这个值得所有在座的大小企业家思考。<br>第三个，我认为新实体经济将会诞生起来。未来三十年会有很多新型实体经济，刚才我已经讲过了，实体经济就是制造和流通，互联网的职责就是创造更多的新实体。实体经济大家讲，我们去救实体经济，我觉得该淘汰的实体经济必须淘汰掉，不是所有的实体经济都是好的，也不是所有的虚拟经济都是糟糕的。我们对破坏生态环境的产业必须淘汰掉，落后生产力必须淘汰，所以互联网经济的主要目的是能够把虚拟经济，把信用体系建立起来，和实体经济互相支撑，其实新金融的第一步就是打造信用体系。我跟金融方面老了很多年，没有过去三十年的二八理论，中国经济不可能发展那么好。但是事实上今天中国很多银行放贷款依旧是靠抵押，这跟100多年以前的当铺没有区别。以前你去当铺把东西给它，它把钱给你，这跟现在没有区别，因为中国社会缺乏信用体系，没有信用体系的社会，所有商业活动的成本是非常高的。所以新金融也好，新技术也好，大数据也好，首先为一个社会打造一个真正的扎实靠得住的信用体系。只有建立这个信用体系，所谓的P2P才可能出现，一定会诞生大批的新实体经济，大家不要觉得实体经济一定会好，未来实体经济真正可以普惠，可以持久发展的经济才可能好。<br>还有一个最近提的新机器人和人的问题，人工智能。我个人觉得，随着数据的大量产生，对数据的利用已经变成人是不可能，现在有人说我是学数据分析，这个人将来就没工作做了。因为未来的数据不可能用脑子去算，一定是用人工机器。大数据的大是指大计算，数据是指云数据。很多公司跟我讲，我们早就是大数据，他以为东西多就是大数据，大数据的大是大计算，数据是云的意思，这是两个不同的概念。过去的时代，特别是过去二三十年，我们把人变成了机器，在流水线上特别明显，未来的二三十年我们将会把机器变成人，机器将会做很多东西。未来肯定有两个不同的方向，美国现在把AI讲的是让机器取代人能做的事情，这个我不太认同，因为美国是几个学者提出来，这些学者确实顶尖聪明，他们看到了未来，但是缺乏实践经验。我前段时间去美国跟一些学者交流以后，他们搞AI有很多是人的大脑意识在里面，把人脑和机器合在一起，我不太认为这是一条正确的道路。如果我们自己对大脑都不了解，你让机器去学习，我认为是有问题的。尤其是这两年吹得神乎其神，人跟机器下围棋，人输掉了，机器跟人之间比聪明，人肯定比机器聪明，人类不要愚蠢到谁力气大，比谁跑得快，比谁更聪明，这些你都没机会。机器永远记得比你牢，永远比你算得快，永远不会生气，我们下围棋的目的就是等人家下一步臭棋，所以我个人觉得机器必须要有自己的思考模式，如果汽车按照人走路应该这么走，但是汽车是轮子走的。所以我的看法是，一定要想办法，机器要做人类做不到的事情，如果这么做，才有机会让机器永远成为人的合作伙伴，而不是人类最大的对手。<br>下面一个问题是未来三十年一个巨大的变革是所有就业会发生很大变化。大家可能在网上看到，几个星期以前杭州有两个抢钱犯，晚上连抢了三个超市被抓住，结果只抢了1600块钱，说超市怎么没钱呢？人家都用手机付钱。现在还有没有人听说去抢出租车司机的？没有了吧，现在司机都是用支付宝和微信，还有杭州有一个要饭的拿一个二维码。很多的就业将会失去掉，每次技术冲击了就业，但是也创新了就业，大家说淘宝、天猫出来以后，对零售冲击很大，淘宝和天猫创造的直接和间接就业机会达到3300万人，这是一个最保守的数字，有没有商场说我们破产了？没有，相反原来在城市里面做建筑工人的人，原来建筑工人是很多的，突然这些人到哪里了？送快递了，原来的复员军人去干什么了？送快递了，就业一定会大型地转移。所以昨天大家看到的技术活很多会被取代，我们必须要去思考，甚至包括在座的CEO们，30年以后时代杂志封面的年度最佳CEO很有可能是一个机器人，它记得比你牢，算得比你快，根本不会对竞争对手生气。过去我们要技术，未来要聚焦文化，而且刚才我问了一个问题，人活到100岁不难，未来随着大数据、大计算，数据能力的提升，未来我们一定能看到癌症被攻破，艾滋病被攻破，一定能看到人类活到100岁不是问题。但同样会看到一些问题，如果没有就业，你自己怎么活？但是有一点可以肯定，十年二十年以后，人类一天工作不到四个小时，休息时间就是很多，因为原来我们一辈子只去了30个地方，今后可能去300个地方，甚至3000个地方，这个世界非常流动。上世纪讲的是制造业，未来讲的是服务业如何让人高兴，包括我前两天去东北看了二人转，觉得很有意思。中国人有些词是很难翻译的，我在美国碰到一些人是搞音乐和电视的，他们问我是搞什么的，我说我是搞文化的，他认为我是搞博物馆的。其实娱乐是真正的艺术，让人快乐，让人娱乐，这是多好的艺术。所以我觉得未来的世界会变得非常快，很多行业要定位清楚到底这世界能创造什么价值。<br>由此可见，由于技术的发展，教育必须改革，必须发展。今天早上我跟五个大使讨论未来问题的时候，我说告诉大家一个坏消息，未来三十年世界变化非常快，而且会非常痛苦。第一次技术革命产生的结果是第一次世界大战，第二次技术革命产生的结果是第二次世界大战，第一次技术革命释放了体能，第二次技术革命释放了距离感，这次是释放了脑力，所以未来30年，这个世界的痛苦要比快乐多多了，因为很多问题我们碰到过。所以我觉得教育必须进行改革，我们从叫知识开始叫文化，让孩子们要有创造力、创新力，更要有好奇心。对企业家来讲，未来的30年世界不属于互联网公司，是属于用好互联网的那些公司。<br>所以给大家最后一个介绍，想清楚今天80后上互联网的人是17亿人，再过10年90后、2000后，这个世界有50-60亿人全是互联网的，你想一想，今天的抵触有什么用？所以希望大家高度关注“30”，第一关注未来30年，第二关注30人以下的企业，第三关注30岁左右的年轻人，只有这样我们才能对未来有希望，有期待，有准备。<br>谢谢大家！</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/02/hexo环境下创建草稿/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/02/hexo环境下创建草稿/" itemprop="url">hexo环境下创建草稿</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T10:51:25+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//新建</div><div class="line">$ hexo new draft &quot;new draft&quot;</div></pre></td></tr></table></figure>
<p>######会在source/_drafts目录下生成一个new-draft.md文件。但是这个文件不被显示在页面上，链接也访问不到。也就是说如果你想把某一篇文章移除显示，又不舍得删除，可以把它移动到_drafts目录之中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//如果你希望强行预览草稿，更改配置文件：</div><div class="line">render_drafts: true</div><div class="line"></div><div class="line">//或者，如下方式启动server：</div><div class="line">$ hexo server --drafts</div><div class="line"></div><div class="line">//把草稿变成文章，或者页面：</div><div class="line">$ hexo publish [layout] &lt;filename&gt;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/05/29/使用Hexo-gitHub搭建个人博客/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/29/使用Hexo-gitHub搭建个人博客/" itemprop="url">使用Hexo+gitHub搭建个人博客</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-29T11:32:54+08:00">
                2017-05-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#操作命令</p>
<p>sudo npm install -g hexo<br>hexo init<br>hexo server</p>
<p>hexo clean<br>hexo generate<br>hexo deploy</p>
<p>#关联github</p>
<p>vim _config.yml<br>deploy:</p>
<p>type: git</p>
<p>repo: <a href="https://github.com/misszero8090/misszero8090.github.io.git" target="_blank" rel="external">https://github.com/misszero8090/misszero8090.github.io.git</a></p>
<p>branch: master</p>
<h1 id="然后执行命令："><a href="#然后执行命令：" class="headerlink" title="然后执行命令："></a>然后执行命令：</h1><p>npm install hexo-deployer-git –save</p>
<p>#一些常用命令：</p>
<p>hexo new”postName” #新建文章</p>
<p>hexo new page”pageName” #新建页面</p>
<p>hexo generate #生成静态页面至public目录</p>
<p>hexo server #开启预览访问端口（默认端口4000，’ctrl + c’关闭server）</p>
<p>hexo deploy #将.deploy目录部署到GitHub</p>
<p>hexo help # 查看帮助</p>
<p>hexo version #查看Hexo的版本</p>
<h1 id="Site-站点信息"><a href="#Site-站点信息" class="headerlink" title="Site #站点信息"></a>Site #站点信息</h1><p>title: blog Name #标题<br>subtitle: Subtitle #副标题<br>description: my blog desc #描述<br>author: me #作者<br>language: zh-CN #语言<br>timezone: Asia/Shanghai #时区</p>
<h1 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h1><p>url: <a href="http://yoururl.com" target="_blank" rel="external">http://yoururl.com</a>   #用于绑定域名, 其他的不需要配置<br>root: /</p>
<p>#permalink: :year/:month/:day/:title/<br>permalink: posts/title.html<br>permalink_defaults:</p>
<h1 id="Directory-目录"><a href="#Directory-目录" class="headerlink" title="Directory #目录"></a>Directory #目录</h1><p>source_dir: source #源文件<br>public_dir: public #生成的网页文件<br>tag_dir: tags #标签<br>archive_dir: archives #归档<br>category_dir: categories #分类<br>code_dir: downloads/code<br>i18n_dir: :lang #国际化<br>skip_render:</p>
<h1 id="Writing-写作"><a href="#Writing-写作" class="headerlink" title="Writing #写作"></a>Writing #写作</h1><p>new_post_name: :title.md #新文章标题<br>default_layout: post #默认模板(post page photo draft)<br>titlecase: false #标题转换成大写<br>external_link: true #新标签页里打开连接<br>filename_case: 0<br>render_drafts: false<br>post_asset_folder: false<br>relative_link: false<br>future: true<br>highlight: #语法高亮<br>enable: true<br>line_number: true #显示行号<br>auto_detect: true<br>tab_replace:</p>
<h1 id="Category-amp-Tag-分类和标签"><a href="#Category-amp-Tag-分类和标签" class="headerlink" title="Category &amp; Tag #分类和标签"></a>Category &amp; Tag #分类和标签</h1><p>default_category: uncategorized #默认分类<br>category_map:<br>tag_map:</p>
<h1 id="Date-Time-format-日期时间格式"><a href="#Date-Time-format-日期时间格式" class="headerlink" title="Date / Time format #日期时间格式"></a>Date / Time format #日期时间格式</h1><h2 id="http-momentjs-com-docs-displaying-format"><a href="#http-momentjs-com-docs-displaying-format" class="headerlink" title="http://momentjs.com/docs/#/displaying/format/"></a><a href="http://momentjs.com/docs/#/displaying/format/" target="_blank" rel="external">http://momentjs.com/docs/#/displaying/format/</a></h2><p>date_format: YYYY-MM-DD<br>time_format: HH:mm:ss</p>
<h1 id="Pagination-分页"><a href="#Pagination-分页" class="headerlink" title="Pagination #分页"></a>Pagination #分页</h1><p>per_page: 10 #每页文章数, 设置成 0 禁用分页<br>pagination_dir: page</p>
<h1 id="Extensions-插件和主题"><a href="#Extensions-插件和主题" class="headerlink" title="Extensions #插件和主题"></a>Extensions #插件和主题</h1><h2 id="插件-http-hexo-io-plugins"><a href="#插件-http-hexo-io-plugins" class="headerlink" title="插件: http://hexo.io/plugins/"></a>插件: <a href="http://hexo.io/plugins/" target="_blank" rel="external">http://hexo.io/plugins/</a></h2><h2 id="主题-http-hexo-io-themes"><a href="#主题-http-hexo-io-themes" class="headerlink" title="主题: http://hexo.io/themes/"></a>主题: <a href="http://hexo.io/themes/" target="_blank" rel="external">http://hexo.io/themes/</a></h2><p>theme: next</p>
<h1 id="Deployment-部署-同时发布在-GitHub-和-GitCafe-上面"><a href="#Deployment-部署-同时发布在-GitHub-和-GitCafe-上面" class="headerlink" title="Deployment #部署, 同时发布在 GitHub 和 GitCafe 上面"></a>Deployment #部署, 同时发布在 GitHub 和 GitCafe 上面</h1><p>deploy:</p>
<ul>
<li>type: git<br>repo: git@gitcafe.com:username/username.git,gitcafe-pages</li>
<li>type: git<br>repo: git@github.com:username/username.github.io.git,master</li>
</ul>
<h1 id="Disqus-Disqus评论系统"><a href="#Disqus-Disqus评论系统" class="headerlink" title="Disqus #Disqus评论系统"></a>Disqus #Disqus评论系统</h1><p>disqus_shortname: </p>
<p>#plugins: #插件，例如生成 RSS 和站点地图的</p>
<ul>
<li>hexo-generator-feed</li>
<li>hexo-generator-sitemap</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/05/23/在swift中使用OC编写的FrameWork库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="靠北’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/在swift中使用OC编写的FrameWork库/" itemprop="url">在swift中使用OC编写的FrameWork库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T11:16:25+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>近来有时间可以看下swift3自己抽时间写了小demo，总体来说swift语言确实言简意赅，抛弃了OC中许多复杂的写法，一下子简便起来还不是很适应。</p>
<p>说到iOS开发就离不开三方库的支持，有一些开源和闭源的SDK使用。</p>
<p>1、集成OC的frameWork需要在swift工程中新建一个用于桥接的 .h 文件 桥接文件中 #import&lt;&gt;相应的文件或者库。</p>
<p>2、新建完成之后，在TAGETS - building setting - 搜索（bri）-Objective-C  bridging Heather - （添加新建的.h桥接文件，建议使用相对路径$(SRCROOT)）</p>
<p>3、导入framework依赖的其他库。</p>
<p>4、Command + b编译运行ok。</p>
<p>5、在swift中可以直接使用。Apple会自动将object - c转为swift。</p>
<p>注：有时候会报莫名的错误，建议检查导入的framework或者.a文件是否包含在工程中，必须是物理包含而不是逻辑包含（也许描述不准确哈）。</p>
<p>示例：在 XXX+bridging+Header.h文件中<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;BmobSDK/Bmob.h&gt;</span></span></div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/headerImage.png"
               alt="yao" />
          <p class="site-author-name" itemprop="name">yao</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">35</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yao</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  
    

    
  




  






  





  

  

  

  

  

  

</body>
</html>
