<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="工具," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="本文章主要我在实际开发过程中常用到的一些方法或函数，未来类似功能可以直接调用或者修改即可使用。本篇将长期更新。 目录   UIGraphicsBeginImageContext消除锯齿 iOS线程 UIbutton图片和文字默认偏移（上下） 判断设置是否越狱 判断是否是数字 判断是否是字符（a-z） 获取当前任务占用的内存 获取中英文混合字符串的长度 获取字节长度 获取app的沙盒路径 为But">
<meta name="keywords" content="工具">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS开发中工具类（方法）">
<meta property="og:url" content="http://he8090.cn/2017/06/06/iOS开发中工具类（方法）/index.html">
<meta property="og:site_name" content="罗尧’s Notes">
<meta property="og:description" content="本文章主要我在实际开发过程中常用到的一些方法或函数，未来类似功能可以直接调用或者修改即可使用。本篇将长期更新。 目录   UIGraphicsBeginImageContext消除锯齿 iOS线程 UIbutton图片和文字默认偏移（上下） 判断设置是否越狱 判断是否是数字 判断是否是字符（a-z） 获取当前任务占用的内存 获取中英文混合字符串的长度 获取字节长度 获取app的沙盒路径 为But">
<meta property="og:updated_time" content="2017-06-28T06:29:30.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS开发中工具类（方法）">
<meta name="twitter:description" content="本文章主要我在实际开发过程中常用到的一些方法或函数，未来类似功能可以直接调用或者修改即可使用。本篇将长期更新。 目录   UIGraphicsBeginImageContext消除锯齿 iOS线程 UIbutton图片和文字默认偏移（上下） 判断设置是否越狱 判断是否是数字 判断是否是字符（a-z） 获取当前任务占用的内存 获取中英文混合字符串的长度 获取字节长度 获取app的沙盒路径 为But">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://he8090.cn/2017/06/06/iOS开发中工具类（方法）/"/>





  <title>iOS开发中工具类（方法） | 罗尧’s Notes</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6961312303680db8ea4d5558f73d8325";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">罗尧’s Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">我用文字记忆，青春年华。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://he8090.cn/2017/06/06/iOS开发中工具类（方法）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/headerImage.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="罗尧’s Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">iOS开发中工具类（方法）</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-06T16:04:47+08:00">
                2017-06-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术分享/" itemprop="url" rel="index">
                    <span itemprop="name">技术分享</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>本文章主要我在实际开发过程中常用到的一些方法或函数，未来类似功能可以直接调用或者修改即可使用。本篇将长期更新。<br></p>
<p>目录</p>
</blockquote>
<ul>
<li>UIGraphicsBeginImageContext消除锯齿</li>
<li>iOS线程</li>
<li>UIbutton图片和文字默认偏移（上下）</li>
<li>判断设置是否越狱</li>
<li>判断是否是数字</li>
<li>判断是否是字符（a-z）</li>
<li>获取当前任务占用的内存</li>
<li>获取中英文混合字符串的长度</li>
<li>获取字节长度</li>
<li>获取app的沙盒路径</li>
<li>为Button绘制背景图片</li>
<li>判断空字符串</li>
<li>判断单个文件大小</li>
<li>获取视频第一帧</li>
<li>获取系统字体</li>
<li>比对与当前时间的天数差</li>
<li>色值转换（#2324512z转UIColor）</li>
<li>通过颜色设置图片</li>
<li>通过颜色设置图片（有高度）</li>
<li>将图片转换为黑白</li>
<li>缓存图片到本地  (注意：需要指定缓存路径，获取到本地沙盒路径等)。</li>
<li>图片裁剪（传入Rect）</li>
<li>按尺寸压缩图片</li>
<li>UIImage两种加载方式比较</li>
</ul>
<hr>
<blockquote>
<p>ARC &amp;&amp; MRC 使用</p>
</blockquote>
<ul>
<li>ARC环境中引入MRC文件  加入<code>-fno-objc-arc</code><br></li>
<li>MRC环境引入ARC文件，加入：<code>-fobjc-arc</code></li>
</ul>
<hr>
<ul>
<li>UIGraphicsBeginImageContext消除锯齿<br>最近在做连线的时候发现，斜线会有锯齿存在。查阅资料发现是像素点原因引起，以下只是简单解决的一种方式，有一定效果但不全面。仅做记录。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">//方法1</div><div class="line">view.layer.contentsScale = [[UIScreen mainScreen] scale];</div><div class="line"></div><div class="line">//方法2</div><div class="line">CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">CGContextSetAllowsAntialiasing(context,true);//开启自动去锯齿</div><div class="line">CGContextSetShouldAntialias(context, true);</div></pre></td></tr></table></figure>
<ul>
<li>iOS线程<blockquote>
<p>一般来说，队列可分为两种类型：串行和并行。也可以分为系统队列和用户队列两种</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>串行：<br>dispatch_get_main_queue() 主线程队列，在主线程中执行<br>dispatch_queue_create(DISPATCH_QUEUE_SERIAL) 自定义串行队列<br>并行：<br>dispatch_get_global_queue() 由系统维护的并行队列<br>dispatch_queue_create(DISPATCH_QUEUE_CONCURRENT) 自定义并发队列</p>
<p>This function is the fundamental mechanism for submitting blocks to a dispatch queue. Calls to this function always return immediately after the block has been submitted and never wait for the block to be invoked. The target queue determines whether the block is invoked serially or concurrently with respect to other blocks submitted to that same queue. Independent serial queues are processed concurrently with respect to each other.</p>
<p>该函数为向dispatch队列中提交block对象的最基础的机制。调用这个接口后将block提交后会马上返回，并不会等待block被调用。参数queue决定block对象是被串行执行还是并行执行。不同的串行队列将被并行处理。</p>
</blockquote>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//在主线程执行一个block</div><div class="line">  dispatch_async(dispatch_get_main_queue(), ^&#123;</div><div class="line">      NSLog(@&quot;invoke in main thread.&quot;);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">  //异步执行一个block</div><div class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">        NSLog(@&quot;invoke in another thread which is in system thread pool.&quot;);</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<ul>
<li>UIbutton图片和文字默认偏移（上下）<br>注意：传入需要设置的Button和文字和图片之间的垂直距离即可。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">+ (void)setButtonImageAndTitleVerticalCenterWithSpace:(CGFloat)space button:(UIButton *)button</div><div class="line">&#123;</div><div class="line">    CGSize imageSize = button.imageView.frame.size;</div><div class="line">    CGSize titleSize = [button.titleLabel.text sizeWithAttributes:@&#123;NSFontAttributeName:[UIFont systemFontOfSize:12]&#125;];</div><div class="line">    CGFloat totalHeight = (imageSize.height + titleSize.height + space);</div><div class="line">    button.imageEdgeInsets = UIEdgeInsetsMake(- (totalHeight - imageSize.height), 0.0, 0.0, - titleSize.width);</div><div class="line">    button.titleEdgeInsets = UIEdgeInsetsMake(0.0, - imageSize.width, - (totalHeight - titleSize.height),0.0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断设置是否越狱</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)isJailbroken &#123;</div><div class="line">    BOOL jailbroken = NO;</div><div class="line">    NSString *cydiaPath = @&quot;/Applications/Cydia.app&quot;;</div><div class="line">    NSString *aptPath = @&quot;/private/var/lib/apt/&quot;;</div><div class="line">    if ([[NSFileManager defaultManager] fileExistsAtPath:cydiaPath]) &#123;</div><div class="line">        jailbroken = YES;</div><div class="line">    &#125;</div><div class="line">    if ([[NSFileManager defaultManager] fileExistsAtPath:aptPath]) &#123;</div><div class="line">        jailbroken = YES;</div><div class="line">    &#125;</div><div class="line">    return jailbroken;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断是否是数字</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (BOOL) validateNumber: (NSString *) number&#123;</div><div class="line">    NSString *reg = @&quot;^[0-9]*$&quot;;</div><div class="line">    NSPredicate *numberTest = [NSPredicate predicateWithFormat:@&quot;SELF MATCHES %@&quot;, reg];</div><div class="line">    return [numberTest evaluateWithObject:number];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断是否是字符（a-z）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (BOOL)validata:(NSString *)number&#123;</div><div class="line">    NSString *regex = @&quot;[A-Za-z]+&quot;;</div><div class="line">    NSPredicate *numberTest = [NSPredicate predicateWithFormat:@&quot;SELF MATCHES %@&quot;, regex];</div><div class="line">    return [numberTest evaluateWithObject:number];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取当前任务占用的内存</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">+ (double)usedMemory</div><div class="line">&#123;</div><div class="line">    task_basic_info_data_t taskInfo;</div><div class="line">    mach_msg_type_number_t infoCount = TASK_BASIC_INFO_COUNT;</div><div class="line">    kern_return_t kernReturn = task_info(mach_task_self(),</div><div class="line">                                         TASK_BASIC_INFO, (task_info_t)&amp;taskInfo, &amp;infoCount);</div><div class="line">    if(kernReturn != KERN_SUCCESS) &#123;</div><div class="line">        return NSNotFound;</div><div class="line">    &#125;</div><div class="line">    return taskInfo.resident_size / 1024.0 / 1024.0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取中英文混合字符串的长度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">+ (int)convertToInt:(NSString*)strtemp</div><div class="line">&#123;</div><div class="line">    int strlength = 0;</div><div class="line">    char* p = (char*)[strtemp cStringUsingEncoding:NSUnicodeStringEncoding];</div><div class="line">    for (int i=0 ; i&lt;[strtemp lengthOfBytesUsingEncoding:NSUnicodeStringEncoding] ;i++) &#123;</div><div class="line">        if (*p) &#123;</div><div class="line">            p++;</div><div class="line">            strlength++;</div><div class="line">        &#125;</div><div class="line">        else &#123;</div><div class="line">            p++;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    return strlength;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取字节长度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">+(NSUInteger) unicodeLengthOfString: (NSString *) text &#123;</div><div class="line">    NSUInteger asciiLength = 0;</div><div class="line"></div><div class="line">    for (NSUInteger i = 0; i &lt; text.length; i++) &#123;</div><div class="line">        unichar uc = [text characterAtIndex: i];</div><div class="line">        asciiLength += isascii(uc) ? 1 : 2;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    NSUInteger unicodeLength = asciiLength / 2;</div><div class="line"></div><div class="line">    if(asciiLength % 2) &#123;</div><div class="line">        unicodeLength++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return unicodeLength;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取app的沙盒路径</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">+ (NSString *)documentPath</div><div class="line">&#123;</div><div class="line">    // 获取应用程序沙盒的Documents目录</div><div class="line">    NSArray *paths=NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES);</div><div class="line">    return [paths objectAtIndex:0];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>为Button绘制背景图片</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">+ (void)backgroundTurnRedForButton:(UIButton *)button red:(CGFloat)red green:(CGFloat)green blue:(CGFloat)blue alpha:(CGFloat)alpha  type:(int) type&#123;</div><div class="line">    CGSize size = button.frame.size;</div><div class="line">    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, size.width, size.height)];</div><div class="line">    view.layer.cornerRadius = 6;</div><div class="line">    view.clipsToBounds = true;</div><div class="line">    view.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:alpha];</div><div class="line">    UIGraphicsBeginImageContext(size);</div><div class="line">    [view.layer renderInContext:UIGraphicsGetCurrentContext()];</div><div class="line"></div><div class="line">    UIImage *screenImage = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line">    switch (type) &#123;</div><div class="line">        case 0:</div><div class="line">            [button setBackgroundImage:screenImage forState:UIControlStateNormal];</div><div class="line">            break;</div><div class="line">        case 1:</div><div class="line">            [button setBackgroundImage:screenImage forState:UIControlStateHighlighted];</div><div class="line">            break;</div><div class="line">        default:</div><div class="line">            break;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断空字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">+(BOOL) isEmptyOrNull:(NSString *) str &#123;</div><div class="line">    if (!str) &#123;</div><div class="line">        // null object</div><div class="line">        return YES;</div><div class="line">    &#125; else &#123;</div><div class="line">        NSString *trimedString = [str stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];</div><div class="line">        if ([trimedString length] == 0) &#123;</div><div class="line">            // empty string</div><div class="line">            return YES;</div><div class="line">        &#125; else &#123;</div><div class="line">            // is neither empty nor null</div><div class="line">            return NO;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>判断单个文件大小</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+(long long)fileSizeAtPath:(NSString*)filePath&#123;</div><div class="line">    NSFileManager* manager = [NSFileManager defaultManager];</div><div class="line">    if ([manager fileExistsAtPath:filePath])&#123;</div><div class="line">        return [[manager attributesOfItemAtPath:filePath error:nil] fileSize];</div><div class="line">    &#125;</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取视频第一帧</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">+(UIImage *)getPreViewImg:(NSString *)url</div><div class="line">&#123;</div><div class="line">    UIImage *img = nil;</div><div class="line">    @autoreleasepool &#123;</div><div class="line">        NSURL *urlvideo = nil;</div><div class="line"></div><div class="line">        if([url hasPrefix:@&quot;assets-library:&quot;] ) &#123;</div><div class="line">            urlvideo = [NSURL URLWithString:url];</div><div class="line">        &#125;else&#123;</div><div class="line">            urlvideo = [[NSURL alloc]initFileURLWithPath:url];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        AVURLAsset *asset = [[AVURLAsset alloc] initWithURL:urlvideo options:nil];</div><div class="line">        AVAssetImageGenerator *gen = [[AVAssetImageGenerator alloc] initWithAsset:asset];</div><div class="line">        gen.appliesPreferredTrackTransform = YES;</div><div class="line">        CMTime time = CMTimeMakeWithSeconds(0.0, 600);</div><div class="line">        NSError *error = nil;</div><div class="line">        CMTime actualTime;</div><div class="line">        CGImageRef image = [gen copyCGImageAtTime:time actualTime:&amp;actualTime error:&amp;error];</div><div class="line">        img = [[UIImage alloc] initWithCGImage:image];</div><div class="line">        CGImageRelease(image);</div><div class="line">    &#125;</div><div class="line">    return img;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取本机IP</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">+ (NSString *)getIPAddress</div><div class="line">&#123;</div><div class="line"></div><div class="line">    NSString *address = @&quot;error&quot;;</div><div class="line">    struct ifaddrs *interfaces = NULL;</div><div class="line">    struct ifaddrs *temp_addr = NULL;</div><div class="line">    int success = 0;</div><div class="line"></div><div class="line">    // retrieve the current interfaces - returns 0 on success</div><div class="line">    success = getifaddrs(&amp;interfaces);</div><div class="line">    if (success == 0) &#123;</div><div class="line">        // Loop through linked list of interfaces</div><div class="line">        temp_addr = interfaces;</div><div class="line">        while (temp_addr != NULL) &#123;</div><div class="line">            if( temp_addr-&gt;ifa_addr-&gt;sa_family == AF_INET) &#123;</div><div class="line">                // Check if interface is en0 which is the wifi connection on the iPhone</div><div class="line">                if ([[NSString stringWithUTF8String:temp_addr-&gt;ifa_name] isEqualToString:@&quot;en0&quot;]) &#123;</div><div class="line">                    // Get NSString from C String</div><div class="line">                    address = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            temp_addr = temp_addr-&gt;ifa_next;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Free memory</div><div class="line">    freeifaddrs(interfaces);</div><div class="line"></div><div class="line">    return address;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>获取系统字体</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">+ (UIFont*)getCurrentFont</div><div class="line">&#123;</div><div class="line">    //判断系统字体的size，返回使用的字体。</div><div class="line">    UIFont *font = [UIFont systemFontOfSize:[UIFont systemFontSize]];</div><div class="line">    return font;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>比对与当前时间的天数差</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">*</div><div class="line"> *对比两个时间</div><div class="line"> *date:需要跟当前时间对比的时间</div><div class="line"> */</div><div class="line">+ (int)getTimedif:(NSDate*)date</div><div class="line">&#123;</div><div class="line">    int num = 0;</div><div class="line">    if (!date) &#123;</div><div class="line">        return num;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    NSCalendar *calendar = [NSCalendar currentCalendar];</div><div class="line">    NSDateComponents *components = [calendar components:NSDayCalendarUnit|NSHourCalendarUnit|NSMinuteCalendarUnit fromDate:[NSDate date]];</div><div class="line">    NSDateComponents *dtComponents = [calendar components:NSDayCalendarUnit|NSHourCalendarUnit|NSMinuteCalendarUnit fromDate:date];</div><div class="line">    num = [components day] - [dtComponents day];</div><div class="line">    return num;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>颜色</p>
</blockquote>
<ul>
<li>色值转换（#2324512z转UIColor）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">+ (UIColor *)hexString:(NSString *)hex&#123;</div><div class="line">    hex = [hex stringByReplacingOccurrencesOfString:@&quot;#&quot; withString:@&quot;&quot;];</div><div class="line">    if (hex.length&lt;6) &#123;</div><div class="line">        return nil;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    unsigned int r,g,b;</div><div class="line">    NSRange stringRange;</div><div class="line"></div><div class="line">    stringRange.length = 2;</div><div class="line">    stringRange.location = 0;</div><div class="line">    [[NSScanner scannerWithString:[hex substringWithRange:stringRange]] scanHexInt:&amp;r];</div><div class="line"></div><div class="line">    stringRange.location = 2;</div><div class="line">    [[NSScanner scannerWithString:[hex substringWithRange:stringRange]] scanHexInt:&amp;g];</div><div class="line"></div><div class="line">    stringRange.location = 4;</div><div class="line">    [[NSScanner scannerWithString:[hex substringWithRange:stringRange]] scanHexInt:&amp;b];</div><div class="line"></div><div class="line">	float fr = (r * 1.0f) / 255.0f;</div><div class="line">	float fg = (g * 1.0f) / 255.0f;</div><div class="line">	float fb = (b * 1.0f) / 255.0f;</div><div class="line"></div><div class="line">	return [UIColor colorWithRed:fr green:fg blue:fb alpha:1.0f];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>通过颜色设置图片</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (UIImage *)createImageWithColor:(UIColor *)color</div><div class="line">&#123;</div><div class="line">    CGRect rect = CGRectMake(0.0f, 0.0f, 1.0f, 1.0f);</div><div class="line">    UIGraphicsBeginImageContext(rect.size);</div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">    CGContextSetFillColorWithColor(context, [color CGColor]);</div><div class="line">    CGContextFillRect(context, rect);</div><div class="line">    UIImage *theImage = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line"></div><div class="line">    return theImage;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>通过颜色设置图片（有高度）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (UIImage*) GetImageWithColor:(UIColor*)color andHeight:(CGFloat)height</div><div class="line">&#123;</div><div class="line">    CGRect r= CGRectMake(0.0f, 0.0f, 1.0f, height);</div><div class="line">    UIGraphicsBeginImageContext(r.size);</div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">    CGContextSetFillColorWithColor(context, [color CGColor]);</div><div class="line">    CGContextFillRect(context, r);</div><div class="line">    UIImage *img = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line">    return img;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>图片处理</p>
</blockquote>
<ul>
<li>裁剪图片为圆形</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">+(UIImage*) circleImage:(UIImage*) image withParam:(CGFloat) inset &#123;</div><div class="line">    UIGraphicsBeginImageContext(image.size);</div><div class="line">    CGContextRef context = UIGraphicsGetCurrentContext();</div><div class="line">    CGContextSetLineWidth(context, 20);</div><div class="line">    CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);</div><div class="line">    CGRect rect = CGRectMake(inset, inset, image.size.width - inset * 2.0f, image.size.height - inset * 2.0f);</div><div class="line">    CGContextAddEllipseInRect(context, rect);</div><div class="line">    CGContextClip(context);</div><div class="line"></div><div class="line">    [image drawInRect:rect];</div><div class="line">    CGContextAddEllipseInRect(context, rect);</div><div class="line">    CGContextStrokePath(context);</div><div class="line">    UIImage *newimg = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">    UIGraphicsEndImageContext();</div><div class="line">    return newimg;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>为图片添加圆角显示</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">//给图片添加圆角显示</div><div class="line">+ (UIImage *) roundCorners: (UIImage*) img</div><div class="line">&#123;</div><div class="line">    int w = img.size.width;</div><div class="line">    int h = img.size.height;</div><div class="line"></div><div class="line">    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();</div><div class="line">    CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 * w, colorSpace, kCGImageAlphaPremultipliedFirst);</div><div class="line"></div><div class="line">    CGContextBeginPath(context);</div><div class="line">    CGRect rect = CGRectMake(0, 0, img.size.width, img.size.height);</div><div class="line">    addRoundedRectToPath(context, rect, 10, 10);</div><div class="line">    CGContextClosePath(context);</div><div class="line">    CGContextClip(context);</div><div class="line"></div><div class="line">    CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);</div><div class="line"></div><div class="line">    CGImageRef imageMasked = CGBitmapContextCreateImage(context);</div><div class="line">    CGContextRelease(context);</div><div class="line">    CGColorSpaceRelease(colorSpace);</div><div class="line">    UIImage *images = [UIImage imageWithCGImage:imageMasked];</div><div class="line">    CGImageRelease(imageMasked);</div><div class="line">    return images;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>将图片转换为黑白</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">+ (UIImage*)blackAndWhitePhoto:(UIImage*)anImage</div><div class="line">&#123;</div><div class="line"></div><div class="line">    CGImageRef imageRef = anImage.CGImage;</div><div class="line"></div><div class="line">    size_t width  = CGImageGetWidth(imageRef);</div><div class="line">    size_t height = CGImageGetHeight(imageRef);</div><div class="line"></div><div class="line">    size_t bitsPerComponent = CGImageGetBitsPerComponent(imageRef);</div><div class="line">    size_t bitsPerPixel = CGImageGetBitsPerPixel(imageRef);</div><div class="line"></div><div class="line">    size_t bytesPerRow = CGImageGetBytesPerRow(imageRef);</div><div class="line"></div><div class="line">    CGColorSpaceRef colorSpace = CGImageGetColorSpace(imageRef);</div><div class="line"></div><div class="line">    CGBitmapInfo bitmapInfo = CGImageGetBitmapInfo(imageRef);</div><div class="line"></div><div class="line"></div><div class="line">    bool shouldInterpolate = CGImageGetShouldInterpolate(imageRef);</div><div class="line"></div><div class="line">    CGColorRenderingIntent intent = CGImageGetRenderingIntent(imageRef);</div><div class="line"></div><div class="line">    CGDataProviderRef dataProvider = CGImageGetDataProvider(imageRef);</div><div class="line"></div><div class="line">    CFDataRef data = CGDataProviderCopyData(dataProvider);</div><div class="line"></div><div class="line">    UInt8 *buffer = (UInt8*)CFDataGetBytePtr(data);</div><div class="line"></div><div class="line">    NSUInteger  x, y;</div><div class="line">    for (y = 0; y &lt; height; y++) &#123;</div><div class="line">        for (x = 0; x &lt; width; x++) &#123;</div><div class="line">            UInt8 *tmp;</div><div class="line">            tmp = buffer + y * bytesPerRow + x * 4;</div><div class="line"></div><div class="line">            UInt8 red,green,blue;</div><div class="line">            red = *(tmp + 0);</div><div class="line">            green = *(tmp + 1);</div><div class="line">            blue = *(tmp + 2);</div><div class="line"></div><div class="line">            UInt8 brightness;</div><div class="line">            brightness = (77 * red + 28 * green + 151 * blue) / 256;</div><div class="line">            *(tmp + 0) = brightness;</div><div class="line">            *(tmp + 1) = brightness;</div><div class="line">            *(tmp + 2) = brightness;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    CFDataRef effectedData = CFDataCreate(NULL, buffer, CFDataGetLength(data));</div><div class="line"></div><div class="line">    CGDataProviderRef effectedDataProvider = CGDataProviderCreateWithCFData(effectedData);</div><div class="line"></div><div class="line">    CGImageRef effectedCgImage = CGImageCreate(</div><div class="line">                                               width, height,</div><div class="line">                                               bitsPerComponent, bitsPerPixel, bytesPerRow,</div><div class="line">                                               colorSpace, bitmapInfo, effectedDataProvider,</div><div class="line">                                               NULL, shouldInterpolate, intent);</div><div class="line"></div><div class="line">    UIImage *effectedImage = [[UIImage alloc] initWithCGImage:effectedCgImage];</div><div class="line"></div><div class="line">    CGImageRelease(effectedCgImage);</div><div class="line"></div><div class="line">    CFRelease(effectedDataProvider);</div><div class="line"></div><div class="line">    CFRelease(effectedData);</div><div class="line"></div><div class="line">    CFRelease(data);</div><div class="line"></div><div class="line">    return effectedImage;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>缓存图片到本地</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">注意：需要指定缓存路径，获取到本地沙盒路径等。</div><div class="line">+ (void)saveImageimageData:(NSData *)imgData</div><div class="line">&#123;</div><div class="line">    NSString *path = @&quot;chat/Image_send/&quot;;</div><div class="line">    if (![[NSFileManager defaultManager]fileExistsAtPath:[[LX_Sandbox docPath] stringByAppendingPathComponent:path]])</div><div class="line">        [[NSFileManager defaultManager]createDirectoryAtPath:[[LX_Sandbox docPath]stringByAppendingPathComponent:path] withIntermediateDirectories:YES attributes:nil error:nil];</div><div class="line"></div><div class="line">    NSString *imgPath = [[[LX_Sandbox docPath]stringByAppendingPathComponent:path]stringByAppendingPathComponent:[NSString stringWithFormat:@&quot;%@.png&quot;,[Function getSendMessageTime]]];</div><div class="line">    if ([[NSFileManager defaultManager]fileExistsAtPath:imgPath]) &#123;</div><div class="line">        [[NSFileManager defaultManager]removeItemAtPath:imgPath error:nil];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if ([[NSFileManager defaultManager]createFileAtPath:imgPath contents:nil attributes:nil]) &#123;</div><div class="line">        [imgData writeToFile:imgPath  atomically:YES];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>图片裁剪（传入Rect）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+(UIImage *)imageCropping:(UIImage*)image  rect:(CGRect)rect&#123;</div><div class="line"></div><div class="line">    CGImageRef cr = CGImageCreateWithImageInRect([image CGImage], rect);</div><div class="line">	UIImage *cropped = [UIImage imageWithCGImage:cr];</div><div class="line">	CGImageRelease(cr);</div><div class="line">    return cropped;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>按尺寸压缩图片</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">+ (UIImage*)scaleFromImage:(UIImage*)image scaledToSize:(CGSize)newSize</div><div class="line">&#123;</div><div class="line">    UIImage* newImage = nil;</div><div class="line">    @autoreleasepool &#123;</div><div class="line">        CGSize  imageSize = image.size;</div><div class="line">        CGFloat width = imageSize.width;</div><div class="line">        CGFloat height = imageSize.height;</div><div class="line"></div><div class="line">        if(width &lt;= newSize.width &amp;&amp; height &lt;= newSize.height)&#123;</div><div class="line">            return image;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if(width == 0 || height == 0)&#123;</div><div class="line">            return image;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        CGFloat widthFactor = newSize.width / width;</div><div class="line">        CGFloat heightFactor = newSize.height / height;</div><div class="line">        CGFloat scaleFactor = (widthFactor&lt;heightFactor?widthFactor:heightFactor);</div><div class="line"></div><div class="line">        CGFloat scaledWidth = width * scaleFactor;</div><div class="line">        CGFloat scaledHeight = height * scaleFactor;</div><div class="line">        CGSize  targetSize = CGSizeMake(scaledWidth,scaledHeight);</div><div class="line"></div><div class="line">        UIGraphicsBeginImageContext(targetSize);</div><div class="line">        [image drawInRect:CGRectMake(0,0,targetSize.width,targetSize.height)];</div><div class="line">        newImage = UIGraphicsGetImageFromCurrentImageContext();</div><div class="line">        UIGraphicsEndImageContext();</div><div class="line">    &#125;</div><div class="line">    return newImage;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>UIImage两种加载方式比较<br>在iOS中根据图片名或路径加载image方式就两种，<code>imageNamed</code>和<code>imageWithContentsOfFile</code>，今天主要说下这两者区别。</li>
</ul>
<blockquote>
<p>imageNamed加载图片会在内存中开辟空间对数据进行缓存，但是当APP内存警告时，不会主动对销毁这部分内存，所以针对多处使用同一个图片来说性能占优。<br>imageWithContentsOfFile则是根据图片路径（全路径）去加载，不会建立缓存，在APP内存警告时会自动销毁这部分内存，所以内存占用占优。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//imageWithContentsOfFile使用方法</div><div class="line">+ (UIImage *)getImageWithSourceOfPath:(NSString *)imageName&#123;</div><div class="line">    if (imageName.length == 0 || imageName == nil) &#123;</div><div class="line">        return [[UIImage alloc]init];</div><div class="line">    &#125;</div><div class="line">    UIImage *image = [UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:imageName ofType:@&quot;png&quot;]];</div><div class="line">    return image;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wxPay.png" alt="yao WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/aliPay.png" alt="yao Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/工具/" rel="tag"># 工具</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/05/swift实现手势解锁绘制/" rel="next" title="iOS实现手势解锁绘制">
                <i class="fa fa-chevron-left"></i> iOS实现手势解锁绘制
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/13/python网络爬虫/" rel="prev" title="python网络爬虫">
                python网络爬虫 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="uyan_frame"></div>
    
  </div>



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/headerImage.png"
               alt="yao" />
          <p class="site-author-name" itemprop="name">yao</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">35</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yao</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  
    

    
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2135471"></script>
      <!-- UY END -->
    
  




  






  





  

  

  

  

  

  

</body>
</html>
